







import c_empty0() as empty0;
import c_empty1(value ) as empty;
import c_empty1(value ) as empty1;
import c_empty2(value ,value ) as empty2;
import c_empty3(value ,value ,value ) as empty3;
import c_empty4(value ,value ,value ,value ) as empty4;
import c_empty5(value ,value ,value ,value ,value ) as empty5;
import c_empty6(value ,value ,value ,value ,value ,value ) as empty6;
import c_df_ready(value ,name ) as df_ready;
import c_df_ready(value ,name ) as df_ready;
import c_df_ready2(value ,value ,name ) as df_ready2;
import c_df_ready3(value ,value ,value ,name ) as df_ready3;
import c_df_ready4(value ,value ,value ,value ,name ) as df_ready4;
import c_check(value ,string ) as check;
import c_check_seq( value ,string ,value ,  name ) as check_seq;

import c_copy(value ,name ) as copy;
import c_copy(value ,name ) as assign;
import c_assign_int(int ,name ) as assign_int;
import c_assign_real(real ,name ) as assign_real;
import c_assign_string( string ,name ) as assign_string;

import c_puts( string ) as puts;
import c_printf( string ) as printf;
import c_printf_d( string ,int ) as printf_d;
import c_printf_dd( string ,int ,int ) as printf_dd;
import c_printf_ddd( string ,int ,int ,int ) as printf_ddd;
import c_printf_dddd( string ,int ,int ,int ,int ) as printf_dddd;
import c_printf_r( string ,real ) as printf_r;

import c_puts_seq( string ,value ,  name ) as puts_seq;
import c_printf_seq( string ,value ,  name ) as printf_seq;
import c_printf_d_seq( string ,int ,value ,  name ) as printf_d_seq;
import c_printf_dd_seq( string ,int ,int ,value ,  name ) as printf_dd_seq;
import c_printf_ddd_seq( string ,int ,int ,int ,value ,  name ) as printf_ddd_seq;
import c_printf_dddd_seq( string ,int ,int ,int ,int ,value ,  name ) as printf_dddd_seq;

import c_sprintf_d(name ,string ,int ) as sprintf_d;
import c_sprintf_dd(name ,string ,int ,int ) as sprintf_dd;
import c_sprintf_ddd(name ,string ,int ,int ,int ) as sprintf_ddd;
import c_sprintf_dddd(name ,string ,int ,int ,int ,int ) as sprintf_dddd;




import c_sscanf_d( string ,  name ) as sscanf_d;
import c_sscanf_dd( string ,  name , name ) as sscanf_dd;
import c_sscanf_ddd( string ,  name , name , name ) as sscanf_ddd;
import c_sscanf_dddd( string ,  name , name , name , name ) as sscanf_dddd;

import c_real_add( real ,real ,  name ) as real_max;
import c_real_max( real ,real ,  name ) as real_add;

import c_real1d_fill( int ,real ,  name ) as real1d_fill;
import c_int1d_fill( int ,int ,  name ) as int1d_fill;
import c_real1d_reduce_max( int ,value ,  name ) as real1d_reduce_max;
import c_real1d_reduce_sum( int ,value ,  name ) as real1d_reduce_sum;
import c_real1d_add( int ,value ,value ,  name ) as real1d_add;
import c_real1d_delta_abs_reduce_max( int n,value ,value ,  name ) as real1d_delta_abs_reduce_max;
import c_real1d_delta_abs_reduce_max( int n,value ,value ,  name ) as real1d_delta_norma_inf;























































import c_real3d_select_xy( int ,int ,int ,int ,int ,int ,int ,value ,int ,  name ) as real3d_select_xy;
import c_real3d_select_xz( int ,int ,int ,int ,int ,int ,int ,value ,int ,  name ) as real3d_select_xz;
import c_real3d_select_yz( int ,int ,int ,int ,int ,int ,int ,value ,int ,  name ) as real3d_select_yz;

import c_real3d_sum_xy( int ,int ,int ,int ,value ,  name ) as real3d_sum_xy;
import c_real3d_sum_xz( int ,int ,int ,int ,value ,  name ) as real3d_sum_xz;
import c_real3d_sum_yz( int ,int ,int ,int ,value ,  name ) as real3d_sum_yz;

import c_real3d_delta_abs_reduce_max( int ,int ,int ,int ,value ,value ,  name ) as real3d_delta_abs_reduce_max;
import c_real3d_delta_abs_reduce_max( int ,int ,int ,int ,value ,value ,  name ) as real3d_delta_norma_inf;

import c_get_fragment_parameters( int ,int ,int ,int ,  name ,name ) as get_fragment_parameters;



sub make_mesh1d_fragmentation( int n,int nf,int nb,  name nfs,name nf0)




{
  for i=0..nf-1 cf getfp[i]: get_fragment_parameters( n,nf,nb,i,  nfs[i],nf0[i]);
}

sub make_mesh3d_fragmentation( name n,name nf,int nb,  name nfs,name nf0)




{
  cf frag0: make_mesh1d_fragmentation( n[0],nf[0],nb,  nfs[0],nf0[0]);
  cf frag1: make_mesh1d_fragmentation( n[1],nf[1],nb,  nfs[1],nf0[1]);
  cf frag2: make_mesh1d_fragmentation( n[2],nf[2],nb,  nfs[2],nf0[2]);
}

sub print_mesh1d_fragmentation_seq( int n,int nf,name nfs,name nf0,name prev,  name next)
{ df seq;
  printf_seq("["+n+" / "+nf+"]:",prev,seq[0]);
  for i=0..nf-1 printf_seq(" "+nf0[i]+":["+nfs[i]+"]",seq[i],seq[i+1]);
  printf_seq("\n",seq[nf],next);
}

sub print_mesh3d_fragmentation_seq( name n,name nf,name nfs,name nf0,name prev,  name next)
{ df seq;
  print_mesh1d_fragmentation_seq( n[0],nf[0],nfs[0],nf0[0],prev  ,seq[1]);
  print_mesh1d_fragmentation_seq( n[1],nf[1],nfs[1],nf0[1],seq[1],seq[2]);
  print_mesh1d_fragmentation_seq( n[2],nf[2],nfs[2],nf0[2],seq[2],next  );
}

sub array3d_real_reduce_max_real( name nf,name v,  name result)
{ df r;
  cf max0: assign_real( v[0][0][0],  r[0]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    let ikl=i*nf[1]*nf[2]+k*nf[2]+l
      cf max1[i][k][l]: assign_real( (r[ikl] > v[i][k][l]) ? real(r[ikl] ): real(v[i][k][l]),  r[ikl+1]);
  cf max2: assign_real( r[nf[0]*nf[1]*nf[2]],  result);
}

sub array3d_int_reduce_sum_int( name nf,name v,  name result)
{ df r;
  cf sum0: assign_int( 0,  r[0]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    let ikl=i*nf[1]*nf[2]+k*nf[2]+l
      cf sum1: assign_int( r[ikl]+v[i][k][l],  r[ikl+1]);
  cf sum2: assign_int( r[nf[0]*nf[1]*nf[2]],  result);
}

sub array3d_real1d_reduce_sum_real1d( name nf,int n,name v,  name result)
{ df r;
  cf sum0: real1d_fill( n,0.0,  r[0]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    let ikl=i*nf[1]*nf[2]+k*nf[2]+l
      cf sum1: real1d_add( n,r[ikl],v[i][k][l],  r[ikl+1]);
  cf sum2: copy( r[nf[0]*nf[1]*nf[2]],  result);
}

sub array3d_real3d_delta_abs_reduce_max_real( name nf,name nfs,int nb,name u,name v,  name result)
{ df d;
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf md: real3d_delta_norma_inf( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],v[i][k][l],  d[i][k][l]);
  array3d_real_reduce_max_real( nf,d,  result);
}

sub array3d_real3d_delta_abs_reduce_max_real_used( name nf,name nfs,int nb,name u,name v,  name result,  name used_u,name used_v)
{ df d;
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf md: real3d_delta_norma_inf( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],v[i][k][l],  d[i][k][l]) >> (used_u[i][k][l],used_v[i][k][l]);
  array3d_real_reduce_max_real( nf,d,  result);
}








import c_write2d_subdomain( string ,int ,int ,value ) as write2d_subdomain;
import c_write2d_part_subdomain( string ,int ,int ,int , int ,int ,int ,int ,value ,value prev,  name ) as write2d_part_subdomain;

import c_gnuplot_script_init( string ,  name ) as gnuplot_script_init;
import c_gnuplot_script_add( string ,string ,int ,int ,value ,  name ) as gnuplot_script_add;



sub write2d_split( string str,int it,int nf0,int nf1,name nfs0,name nfs1,name u)





{
  for i=0..nf0-1 for j=0..nf1-1
  { df filename;
    cf wr0: sprintf_ddd(filename,str+"%06d_%03d_%03d.dat",it,i,j);
    cf wr1: write2d_subdomain( filename,nfs0[i],nfs1[j],u[i][j]);
  }
}

sub write2d( string str,int it,int n0,int n1,int nf0,int nf1,name nfs0,name nfs1,name nf00,name nf01,int nb,name u)








{ df filename,seq;
  cf wr0: assign_int( 0,  seq[0]);
  cf wr1: sprintf_d(filename,str+"%06d.dat",it);
  for i=0..nf0-1 for j=0..nf1-1
    let ij = i*nf1+j
      cf wr2: write2d_part_subdomain( filename,n0,n1,nfs0[i],nfs1[j],nf00[i],nf01[i],nb,u[i][j],seq[ij],  seq[ij+1]);
}

sub write2d_split_plt( string str,int it,int nf0,int nf1,name nfs0,name nfs1,name u,string scriptname,name prev,  name next)





{ df seqplt;
  cf wr0: assign( prev,  seqplt[0]);
  for i=0..nf0-1 for j=0..nf1-1
  { df filename;
    cf wr1: sprintf_ddd(filename,str+"%06d_%03d_%03d.dat",it,i,j);
    
    cf wr2: write2d_subdomain( filename,nfs0[i],nfs1[j],u[i][j]);
    cf wr3: gnuplot_script_add( scriptname,filename,nfs0[i],nfs1[j],seqplt[i*nf1+j],  seqplt[i*nf1+j+1]);
  }
  cf wr4: assign( seqplt[nf0*nf1],  next);
}

sub write2d_plt( string str,int it,int n0,int n1,int nf0,int nf1,name nfs0,name nfs1,name nf00,name nf01,int nb,name u,string scriptname,name prev,  name next)








{ df filename,seq;
  cf wr0: assign_int( 0,  seq[0]);
  cf wr1: sprintf_d(filename,str+"%06d.dat",it);
  for i=0..nf0-1 for j=0..nf1-1
    let ij = i*nf1+j
      cf wr2: write2d_part_subdomain( filename,n0,n1,nfs0[i],nfs1[j],nf00[i],nf01[j],nb,u[i][j],seq[ij],  seq[ij+1]);
  cf wr3: gnuplot_script_add( scriptname,filename,n0,n1,prev,  next);
}




sub log_sxy_split( string str,int it,name nf,name nfs,int nb,name u)






{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_split( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy);
}

sub log_sxz_split( string str,int it,name nf,name nfs,int nb,name u)






{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_split( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz);
}

sub log_syz_split( string str,int it,name nf,name nfs,int nb,name u)






{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_split( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz);
}

sub log_xy_split( string str,int it,name nf,name nfs,name nf0,int nb,name u,int lg)








{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]);
  cf wrt: write2d_split( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy);
}

sub log_xz_split( string str,int it,name nf,name nfs,name nf0,int nb,name u,int kg)








{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]);
  cf wrt: write2d_split( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz);
}

sub log_yz_split( string str,int it,name nf,name nfs,name nf0,int nb,name u,int ig)








{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]);
  cf wrt: write2d_split( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz);
}




sub log_sxy_split_plt( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next)






{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy,scriptname,prev,  next);
}

sub log_sxz_split_plt( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next)






{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz,scriptname,prev,  next);
}

sub log_syz_split_plt( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next)






{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz,scriptname,prev,  next);
}

sub log_xy_split_plt( string str,int it,name nf,name nfs,name nf0,int nb,name u,int lg,string scriptname,name prev,  name next)








{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]);
  cf wrt: write2d_split_plt( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy,scriptname,prev,  next);
}

sub log_xz_split_plt( string str,int it,name nf,name nfs,name nf0,int nb,name u,int kg,string scriptname,name prev,  name next)








{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]);
  cf wrt: write2d_split_plt( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz,scriptname,prev,  next);
}

sub log_yz_split_plt( string str,int it,name nf,name nfs,name nf0,int nb,name u,int ig,string scriptname,name prev,  name next)








{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]);
  cf wrt: write2d_split_plt( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz,scriptname,prev,  next);
}




sub log_sxy( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u)








{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy);
}

sub log_sxz( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u)








{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz);
}

sub log_syz( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u)








{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz);
}

sub log_xy( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int lg)









{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]);
  cf wrt: write2d( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy);
}

sub log_xz( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int kg)









{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]);
  cf wrt: write2d( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz);
}

sub log_yz( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int ig)









{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]);
  cf wrt: write2d( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz);
}




sub log_sxy_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_sxz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_syz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}

sub log_xy_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int lg,string scriptname,name prev,  name next)









{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]);
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_xz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int kg,string scriptname,name prev,  name next)









{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]);
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_yz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int ig,string scriptname,name prev,  name next)









{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]);
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}




sub log_sxy_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_sxz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_syz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next)








{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}

sub log_xy_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int lg,string scriptname,name prev,  name next)









{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]);
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_xz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int kg,string scriptname,name prev,  name next)









{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]);
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_yz_plt( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int ig,string scriptname,name prev,  name next)









{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]);
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}




sub log_sxy_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next,  name used_u)








{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_sxz_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next,  name used_u)








{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_syz_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,string scriptname,name prev,  name next,  name used_u)








{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}

sub log_xy_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int lg,string scriptname,name prev,  name next,  name used_u)









{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]) >> (used_u[i][k][l]);
    if (lg< ((1)+(nf0[2][l])) || lg>= ((nfs[2][l]-1)+(nf0[2][l]))) cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_plt( str,it,n[0],n[1],nf[0],nf[1],nfs[0],nfs[1],nf0[0],nf0[1],1,uxy,scriptname,prev,  next);
}

sub log_xz_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int kg,string scriptname,name prev,  name next,  name used_u)









{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]) >> (used_u[i][k][l]);
    if (kg< ((1)+(nf0[1][k])) || kg>= ((nfs[1][k]-1)+(nf0[1][k]))) cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_plt( str,it,n[0],n[2],nf[0],nf[2],nfs[0],nfs[2],nf0[0],nf0[2],1,uxz,scriptname,prev,  next);
}

sub log_yz_plt_used( string str,int it,name n,name nf,name nfs,name nf0,int nb,name u,int ig,string scriptname,name prev,  name next,  name used_u)









{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]) >> (used_u[i][k][l]);
    if (ig< ((1)+(nf0[0][i])) || ig>= ((nfs[0][i]-1)+(nf0[0][i]))) cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_plt( str,it,n[1],n[2],nf[1],nf[2],nfs[1],nfs[2],nf0[1],nf0[2],1,uyz,scriptname,prev,  next);
}




sub log_sxy_split_plt_used( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next,  name used_u)






{
  df u2d,s,    
     uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xy( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 let nxy=nfs[0][i]*nfs[1][k]
  { if (nf[2]==1) cf copy: copy( u2d[i][k][0],  uxy[i][k]);
    if (nf[2]==2) cf add0: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  uxy[i][k]);
    if (nf[2]>2)
    { cf add1: real1d_add( nxy,u2d[i][k][0],u2d[i][k][1],  s[i][k][1]);
      for l=2..nf[2]-2 cf add2: real1d_add( nxy,s[i][k][l-1],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxy,s[i][k][nf[2]-2],u2d[i][k][nf[2]-1],  uxy[i][k]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy,scriptname,prev,  next);
}

sub log_sxz_split_plt_used( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next,  name used_u)






{
  df u2d,s,    
     uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_xz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for i=0..nf[0]-1 for l=0..nf[2]-1 let nxz=nfs[0][i]*nfs[2][l]
  { if (nf[1]==1) cf copy: copy( u2d[i][0][l],  uxz[i][l]);
    if (nf[1]==2) cf add0: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  uxz[i][l]);
    if (nf[1]>2)
    { cf add1: real1d_add( nxz,u2d[i][0][l],u2d[i][1][l],  s[i][1][l]);
      for k=2..nf[1]-2 cf add2: real1d_add( nxz,s[i][k-1][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nxz,s[i][nf[1]-2][l],u2d[i][nf[1]-1][l],  uxz[i][l]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz,scriptname,prev,  next);
}

sub log_syz_split_plt_used( string str,int it,name nf,name nfs,int nb,name u,string scriptname,name prev,  name next,  name used_u)






{
  df u2d,s,    
     uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf sum: real3d_sum_yz( nfs[0][i],nfs[1][k],nfs[2][l],nb,u[i][k][l],  u2d[i][k][l]) >> (used_u[i][k][l]);
  for k=0..nf[1]-1 for l=0..nf[2]-1 let nyz=nfs[1][k]*nfs[2][l]
  { if (nf[0]==1) cf copy: copy( u2d[0][k][l],  uyz[k][l]);
    if (nf[0]==2) cf add0: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  uyz[k][l]);
    if (nf[0]>2)
    { cf add1: real1d_add( nyz,u2d[0][k][l],u2d[1][k][l],  s[1][k][l]);
      for i=2..nf[0]-2 cf add2: real1d_add( nyz,s[i-1][k][l],u2d[i][k][l],  s[i][k][l]);
      cf add3: real1d_add( nyz,s[nf[0]-2][k][l],u2d[nf[0]-1][k][l],  uyz[k][l]);
    }
  }
  cf wrt: write2d_split_plt( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz,scriptname,prev,  next);
}

sub log_xy_split_plt_used( string str,int it,name nf,name nfs,name nf0,int nb,name u,int lg,string scriptname,name prev,  name next,  name used_u)








{
  df uxy;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (lg>= ((1)+(nf0[2][l])) && lg< ((nfs[2][l]-1)+(nf0[2][l])))
      cf sel: real3d_select_xy( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],lg,  uxy[i][k]) >> (used_u[i][k][l]);
    if (lg< ((1)+(nf0[2][l])) || lg>= ((nfs[2][l]-1)+(nf0[2][l])))
      cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[1],nfs[0],nfs[1],uxy,scriptname,prev,  next);
}

sub log_xz_split_plt_used( string str,int it,name nf,name nfs,name nf0,int nb,name u,int kg,string scriptname,name prev,  name next,  name used_u)








{
  df uxz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (kg>= ((1)+(nf0[1][k])) && kg< ((nfs[1][k]-1)+(nf0[1][k])))
      cf sel: real3d_select_xz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],kg,  uxz[i][l]) >> (used_u[i][k][l]);
    if (kg< ((1)+(nf0[1][k])) || kg>= ((nfs[1][k]-1)+(nf0[1][k])))
      cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_split_plt( str,it,nf[0],nf[2],nfs[0],nfs[2],uxz,scriptname,prev,  next);
}

sub log_yz_split_plt_used( string str,int it,name nf,name nfs,name nf0,int nb,name u,int ig,string scriptname,name prev,  name next,  name used_u)








{
  df uyz;      
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    if (ig>= ((1)+(nf0[0][i])) && ig< ((nfs[0][i]-1)+(nf0[0][i])))
      cf sel: real3d_select_yz( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],nb,u[i][k][l],ig,  uyz[k][l]) >> (used_u[i][k][l]);
    if (ig< ((1)+(nf0[0][i])) || ig>= ((nfs[0][i]-1)+(nf0[0][i])))
      cf use: empty0() >> (used_u[i][k][l]);
  }
  cf wrt: write2d_split_plt( str,it,nf[1],nf[2],nfs[1],nfs[2],uyz,scriptname,prev,  next);
}








import c_poisson3d_step_implicit_subdomain( int ,int ,int ,int ,int ,int ,
              int ,int ,int ,real ,real ,real ,
              real ,real ,value ,value ,  name ,name ) as poisson3d_step_implicit_subdomain;
import c_poisson3d_step_explicit_subdomain( int ,int ,int ,int ,int ,int ,
              int ,int ,int ,real ,real ,real ,
              real ,real ,value ,value ,  name ,name ) as poisson3d_step_explicit_subdomain;

sub poisson3d_solve_explicit( name nf,name nfs,name h,real wp,real eps,real crhs,int nb,name ro,name fi_old,  name fi_new,name count,  name used_fi)









{ df fi,       
     delta,    
     fi_ready; 
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf cpin[i][k][l]: copy( fi_old[i][k][l],  fi[0][i][k][l]) >> (used_fi[i][k][l]);
  cf i_delta0: assign( eps,  delta[0]);
  while delta[cnt] >= eps, cnt=0..out count
  { df fit, 
       d;   
    for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
      cf slv[cnt][i][k][l]: poisson3d_step_explicit_subdomain( nf[0],nf[1],nf[2],i,k,l,nfs[0][i],nfs[1][k],nfs[2][l],h[0],h[1],h[2],wp,crhs,ro[i][k][l],fi[cnt][i][k][l],  fit[i][k][l],d[i][k][l]) --> (fi[cnt][i][k][l]);
    cf exch[cnt]: mesh3d_exchange_6( nf,nfs,fit,  fi[cnt+1]);
    cf max[cnt]: array3d_real_reduce_max_real( nf,d,  delta[cnt+1]) --> (delta[cnt]);
    if ((cnt+1)%10==0)
    { cf prnd[cnt]: puts("P["+int(cnt+1)+"]: "+delta[cnt+1]);
      
    }
  }
  cf exchout: mesh3d_exchange_27( nf,nfs,fi[count],  fi_new);
}

sub poisson3d_solve_implicit( name nf,name nfs,name h,real wp,real eps,real crhs,int nb,name ro,name fi_old,  name fi_new,name count,  name used_fi)









{ df fi,       
     delta,    
     fi_ready; 
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf cpin[i][k][l]: copy( fi_old[i][k][l],  fi[0][i][k][l]) >> (used_fi[i][k][l]);
  cf i_delta0: assign( eps,  delta[0]);
  while delta[cnt] >= eps, cnt=0..out count
  { df fit, 
       d;   
    for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
      cf slv[cnt][i][k][l]: poisson3d_step_implicit_subdomain( nf[0],nf[1],nf[2],i,k,l,nfs[0][i],nfs[1][k],nfs[2][l],h[0],h[1],h[2],wp,crhs,ro[i][k][l],fi[cnt][i][k][l],  fit[i][k][l],d[i][k][l]) --> (fi[cnt][i][k][l]);
    cf exch[cnt]: mesh3d_exchange_6( nf,nfs,fit,  fi[cnt+1]);
    cf max[cnt]: array3d_real_reduce_max_real( nf,d,  delta[cnt+1]) --> (delta[cnt]);
    if ((cnt+1)%10==0)
    { cf prnd[cnt]: puts("P["+int(cnt+1)+"]: "+delta[cnt+1]);
      
    }
  }
  cf exchout: mesh3d_exchange_27( nf,nfs,fi[count],  fi_new);
}




































import c_mesh3d_exchange_6_copy_00_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_copy_00_00_00;
import c_mesh3d_exchange_6_get_00_00_01( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_00_00_01;
import c_mesh3d_exchange_6_set_00_00_01( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_00_00_01;
import c_mesh3d_exchange_6_get_00_00_10( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_00_00_10;
import c_mesh3d_exchange_6_set_00_00_10( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_00_00_10;
import c_mesh3d_exchange_6_get_00_00_11( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_00_11;
import c_mesh3d_exchange_6_set_00_00_11( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_00_11;
import c_mesh3d_exchange_6_get_00_01_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_00_01_00;
import c_mesh3d_exchange_6_set_00_01_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_00_01_00;
import c_mesh3d_exchange_6_get_00_01_01( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_01_01;
import c_mesh3d_exchange_6_set_00_01_01( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_01_01;
import c_mesh3d_exchange_6_get_00_01_10( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_01_10;
import c_mesh3d_exchange_6_set_00_01_10( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_01_10;
import c_mesh3d_exchange_6_get_00_01_11( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_00_01_11;
import c_mesh3d_exchange_6_set_00_01_11( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_01_11;
import c_mesh3d_exchange_6_get_00_10_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_00_10_00;
import c_mesh3d_exchange_6_set_00_10_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_00_10_00;
import c_mesh3d_exchange_6_get_00_10_01( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_10_01;
import c_mesh3d_exchange_6_set_00_10_01( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_10_01;
import c_mesh3d_exchange_6_get_00_10_10( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_10_10;
import c_mesh3d_exchange_6_set_00_10_10( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_10_10;
import c_mesh3d_exchange_6_get_00_10_11( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_00_10_11;
import c_mesh3d_exchange_6_set_00_10_11( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_10_11;
import c_mesh3d_exchange_6_get_00_11_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_00_11_00;
import c_mesh3d_exchange_6_set_00_11_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_11_00;
import c_mesh3d_exchange_6_get_00_11_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_00_11_01;
import c_mesh3d_exchange_6_set_00_11_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_11_01;
import c_mesh3d_exchange_6_get_00_11_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_00_11_10;
import c_mesh3d_exchange_6_set_00_11_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_11_10;
import c_mesh3d_exchange_6_get_00_11_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_00_11_11;
import c_mesh3d_exchange_6_set_00_11_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_00_11_11;
import c_mesh3d_exchange_6_get_01_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_01_00_00;
import c_mesh3d_exchange_6_set_01_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_01_00_00;
import c_mesh3d_exchange_6_get_01_00_01( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_01_00_01;
import c_mesh3d_exchange_6_set_01_00_01( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_00_01;
import c_mesh3d_exchange_6_get_01_00_10( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_01_00_10;
import c_mesh3d_exchange_6_set_01_00_10( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_00_10;
import c_mesh3d_exchange_6_get_01_00_11( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_00_11;
import c_mesh3d_exchange_6_set_01_00_11( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_00_11;
import c_mesh3d_exchange_6_get_01_01_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_01_01_00;
import c_mesh3d_exchange_6_set_01_01_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_01_00;
import c_mesh3d_exchange_6_get_01_01_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_01_01;
import c_mesh3d_exchange_6_set_01_01_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_01_01;
import c_mesh3d_exchange_6_get_01_01_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_01_10;
import c_mesh3d_exchange_6_set_01_01_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_01_10;
import c_mesh3d_exchange_6_get_01_01_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_01_01_11;
import c_mesh3d_exchange_6_set_01_01_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_01_11;
import c_mesh3d_exchange_6_get_01_10_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_01_10_00;
import c_mesh3d_exchange_6_set_01_10_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_10_00;
import c_mesh3d_exchange_6_get_01_10_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_10_01;
import c_mesh3d_exchange_6_set_01_10_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_10_01;
import c_mesh3d_exchange_6_get_01_10_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_10_10;
import c_mesh3d_exchange_6_set_01_10_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_10_10;
import c_mesh3d_exchange_6_get_01_10_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_01_10_11;
import c_mesh3d_exchange_6_set_01_10_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_10_11;
import c_mesh3d_exchange_6_get_01_11_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_01_11_00;
import c_mesh3d_exchange_6_set_01_11_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_11_00;
import c_mesh3d_exchange_6_get_01_11_01( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_01_11_01;
import c_mesh3d_exchange_6_set_01_11_01( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_11_01;
import c_mesh3d_exchange_6_get_01_11_10( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_01_11_10;
import c_mesh3d_exchange_6_set_01_11_10( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_11_10;
import c_mesh3d_exchange_6_get_01_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_01_11_11;
import c_mesh3d_exchange_6_set_01_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_01_11_11;
import c_mesh3d_exchange_6_get_10_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_6_get_10_00_00;
import c_mesh3d_exchange_6_set_10_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_6_set_10_00_00;
import c_mesh3d_exchange_6_get_10_00_01( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_10_00_01;
import c_mesh3d_exchange_6_set_10_00_01( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_00_01;
import c_mesh3d_exchange_6_get_10_00_10( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_10_00_10;
import c_mesh3d_exchange_6_set_10_00_10( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_00_10;
import c_mesh3d_exchange_6_get_10_00_11( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_00_11;
import c_mesh3d_exchange_6_set_10_00_11( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_00_11;
import c_mesh3d_exchange_6_get_10_01_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_10_01_00;
import c_mesh3d_exchange_6_set_10_01_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_01_00;
import c_mesh3d_exchange_6_get_10_01_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_01_01;
import c_mesh3d_exchange_6_set_10_01_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_01_01;
import c_mesh3d_exchange_6_get_10_01_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_01_10;
import c_mesh3d_exchange_6_set_10_01_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_01_10;
import c_mesh3d_exchange_6_get_10_01_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_10_01_11;
import c_mesh3d_exchange_6_set_10_01_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_01_11;
import c_mesh3d_exchange_6_get_10_10_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_10_10_00;
import c_mesh3d_exchange_6_set_10_10_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_10_00;
import c_mesh3d_exchange_6_get_10_10_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_10_01;
import c_mesh3d_exchange_6_set_10_10_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_10_01;
import c_mesh3d_exchange_6_get_10_10_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_10_10;
import c_mesh3d_exchange_6_set_10_10_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_10_10;
import c_mesh3d_exchange_6_get_10_10_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_10_10_11;
import c_mesh3d_exchange_6_set_10_10_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_10_11;
import c_mesh3d_exchange_6_get_10_11_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_10_11_00;
import c_mesh3d_exchange_6_set_10_11_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_11_00;
import c_mesh3d_exchange_6_get_10_11_01( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_10_11_01;
import c_mesh3d_exchange_6_set_10_11_01( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_11_01;
import c_mesh3d_exchange_6_get_10_11_10( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_10_11_10;
import c_mesh3d_exchange_6_set_10_11_10( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_11_10;
import c_mesh3d_exchange_6_get_10_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_10_11_11;
import c_mesh3d_exchange_6_set_10_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_10_11_11;
import c_mesh3d_exchange_6_get_11_00_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_6_get_11_00_00;
import c_mesh3d_exchange_6_set_11_00_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_00_00;
import c_mesh3d_exchange_6_get_11_00_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_11_00_01;
import c_mesh3d_exchange_6_set_11_00_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_00_01;
import c_mesh3d_exchange_6_get_11_00_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_11_00_10;
import c_mesh3d_exchange_6_set_11_00_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_00_10;
import c_mesh3d_exchange_6_get_11_00_11( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_00_11;
import c_mesh3d_exchange_6_set_11_00_11( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_00_11;
import c_mesh3d_exchange_6_get_11_01_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_11_01_00;
import c_mesh3d_exchange_6_set_11_01_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_01_00;
import c_mesh3d_exchange_6_get_11_01_01( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_01_01;
import c_mesh3d_exchange_6_set_11_01_01( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_01_01;
import c_mesh3d_exchange_6_get_11_01_10( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_01_10;
import c_mesh3d_exchange_6_set_11_01_10( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_01_10;
import c_mesh3d_exchange_6_get_11_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_11_01_11;
import c_mesh3d_exchange_6_set_11_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_01_11;
import c_mesh3d_exchange_6_get_11_10_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_6_get_11_10_00;
import c_mesh3d_exchange_6_set_11_10_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_10_00;
import c_mesh3d_exchange_6_get_11_10_01( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_10_01;
import c_mesh3d_exchange_6_set_11_10_01( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_10_01;
import c_mesh3d_exchange_6_get_11_10_10( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_10_10;
import c_mesh3d_exchange_6_set_11_10_10( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_10_10;
import c_mesh3d_exchange_6_get_11_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_11_10_11;
import c_mesh3d_exchange_6_set_11_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_10_11;
import c_mesh3d_exchange_6_get_11_11_00( int ,int ,int ,value ,  name ,name ,name ,name ) as mesh3d_exchange_6_get_11_11_00;
import c_mesh3d_exchange_6_set_11_11_00( int ,int ,int ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_11_00;
import c_mesh3d_exchange_6_get_11_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_11_11_01;
import c_mesh3d_exchange_6_set_11_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_11_01;
import c_mesh3d_exchange_6_get_11_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_11_11_10;
import c_mesh3d_exchange_6_set_11_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_11_10;
import c_mesh3d_exchange_6_get_11_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_6_get_11_11_11;
import c_mesh3d_exchange_6_set_11_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_6_set_11_11_11;

sub mesh3d_exchange111_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf cpy000000[i][k][l]: mesh3d_exchange_6_copy_00_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],  v[i][k][l]);
  }
}

sub mesh3d_exchange112_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_6_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_6_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_6_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_6_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange113_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000011[i][k][l]: mesh3d_exchange_6_get_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set000011[i][k][l]: mesh3d_exchange_6_set_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_6_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_6_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_6_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_6_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange121_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_6_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_6_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_6_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_6_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange122_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_6_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_6_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_6_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_6_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_6_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_6_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_6_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_6_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange123_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_6_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_6_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_6_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_6_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_6_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_6_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_6_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_6_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_6_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_6_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_6_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_6_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange131_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001100[i][k][l]: mesh3d_exchange_6_get_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set001100[i][k][l]: mesh3d_exchange_6_set_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_6_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_6_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_6_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_6_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange132_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_6_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_6_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_6_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_6_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_6_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_6_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_6_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_6_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_6_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_6_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_6_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_6_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange133_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_6_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_6_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_6_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_6_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_6_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_6_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get001111[i][k][l]: mesh3d_exchange_6_get_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set001111[i][k][l]: mesh3d_exchange_6_set_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_6_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_6_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_6_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_6_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_6_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_6_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_6_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_6_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_6_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_6_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange211_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_6_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_6_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_6_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_6_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange212_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_6_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_6_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_6_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_6_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_6_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_6_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_6_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_6_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange213_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_6_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_6_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_6_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_6_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_6_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_6_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_6_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_6_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_6_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_6_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_6_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_6_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange221_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_6_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_6_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_6_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_6_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_6_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_6_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_6_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_6_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange222_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange223_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_6_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_6_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_6_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_6_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_6_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_6_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_6_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_6_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange231_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_6_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_6_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_6_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_6_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_6_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_6_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_6_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_6_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_6_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_6_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_6_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_6_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange232_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_6_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_6_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_6_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_6_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_6_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_6_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_6_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_6_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange233_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_6_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_6_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_6_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_6_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_6_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_6_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_6_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_6_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_6_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_6_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_6_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_6_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_6_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_6_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_6_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_6_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_6_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_6_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_6_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_6_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange311_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_6_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_6_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110000[i][k][l]: mesh3d_exchange_6_get_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 22][i][k][l]);
    cf set110000[i][k][l]: mesh3d_exchange_6_set_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_6_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_6_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange312_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_6_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_6_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_6_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_6_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_6_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_6_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_6_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_6_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_6_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_6_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_6_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_6_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange313_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_6_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_6_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_6_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_6_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_6_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_6_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_6_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_6_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_6_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_6_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110011[i][k][l]: mesh3d_exchange_6_get_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set110011[i][k][l]: mesh3d_exchange_6_set_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_6_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_6_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_6_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_6_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_6_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_6_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange321_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_6_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_6_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_6_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_6_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_6_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_6_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_6_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_6_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_6_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_6_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_6_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_6_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange322_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_6_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_6_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_6_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_6_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_6_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_6_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_6_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_6_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange323_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_6_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_6_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_6_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_6_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_6_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_6_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_6_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_6_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_6_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_6_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_6_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_6_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_6_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_6_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_6_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_6_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_6_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_6_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_6_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_6_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange331_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_6_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_6_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_6_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_6_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_6_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_6_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_6_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_6_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111100[i][k][l]: mesh3d_exchange_6_get_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111100[i][k][l]: mesh3d_exchange_6_set_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_6_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_6_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_6_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_6_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_6_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_6_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_6_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_6_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange332_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_6_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_6_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_6_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_6_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_6_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_6_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_6_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_6_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_6_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_6_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_6_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_6_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_6_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_6_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_6_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_6_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_6_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_6_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_6_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_6_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange333_6( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_6_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_6_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_6_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_6_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_6_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_6_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_6_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_6_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_6_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_6_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_6_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_6_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_6_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_6_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_6_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_6_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_6_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_6_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_6_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_6_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_6_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_6_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_6_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_6_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_6_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_6_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_6_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_6_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_6_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_6_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_6_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_6_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_6_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_6_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_6_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_6_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_6_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_6_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_6_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_6_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_6_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_6_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_6_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_6_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_6_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_6_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_6_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_6_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_6_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_6_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_6_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_6_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get111111[i][k][l]: mesh3d_exchange_6_get_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l]);
    cf set111111[i][k][l]: mesh3d_exchange_6_set_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange_6( name nf,name nfs,name u,  name v)




{
  if (nf[0] == 1)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex111: mesh3d_exchange111_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex112: mesh3d_exchange112_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex113: mesh3d_exchange113_6( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex121: mesh3d_exchange121_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex122: mesh3d_exchange122_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex123: mesh3d_exchange123_6( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex131: mesh3d_exchange131_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex132: mesh3d_exchange132_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex133: mesh3d_exchange133_6( nf,nfs,u,  v);
    }
  }
  if (nf[0] == 2)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex211: mesh3d_exchange211_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex212: mesh3d_exchange212_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex213: mesh3d_exchange213_6( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex221: mesh3d_exchange221_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex222: mesh3d_exchange222_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex223: mesh3d_exchange223_6( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex231: mesh3d_exchange231_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex232: mesh3d_exchange232_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex233: mesh3d_exchange233_6( nf,nfs,u,  v);
    }
  }
  if (nf[0] >= 3)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex311: mesh3d_exchange311_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex312: mesh3d_exchange312_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex313: mesh3d_exchange313_6( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex321: mesh3d_exchange321_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex322: mesh3d_exchange322_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex323: mesh3d_exchange323_6( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex331: mesh3d_exchange331_6( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex332: mesh3d_exchange332_6( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex333: mesh3d_exchange333_6( nf,nfs,u,  v);
    }
  }
}

































































import c_mesh3d_exchange_27_copy_00_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_copy_00_00_00;
import c_mesh3d_exchange_27_get_00_00_01( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_00_00_01;
import c_mesh3d_exchange_27_set_00_00_01( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_00_00_01;
import c_mesh3d_exchange_27_get_00_00_10( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_00_00_10;
import c_mesh3d_exchange_27_set_00_00_10( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_00_00_10;
import c_mesh3d_exchange_27_get_00_00_11( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_27_get_00_00_11;
import c_mesh3d_exchange_27_set_00_00_11( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_00_11;
import c_mesh3d_exchange_27_get_00_01_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_00_01_00;
import c_mesh3d_exchange_27_set_00_01_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_00_01_00;
import c_mesh3d_exchange_27_get_00_01_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_00_01_01;
import c_mesh3d_exchange_27_set_00_01_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_01_01;
import c_mesh3d_exchange_27_get_00_01_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_00_01_10;
import c_mesh3d_exchange_27_set_00_01_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_01_10;
import c_mesh3d_exchange_27_get_00_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_00_01_11;
import c_mesh3d_exchange_27_set_00_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_01_11;
import c_mesh3d_exchange_27_get_00_10_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_00_10_00;
import c_mesh3d_exchange_27_set_00_10_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_00_10_00;
import c_mesh3d_exchange_27_get_00_10_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_00_10_01;
import c_mesh3d_exchange_27_set_00_10_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_10_01;
import c_mesh3d_exchange_27_get_00_10_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_00_10_10;
import c_mesh3d_exchange_27_set_00_10_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_10_10;
import c_mesh3d_exchange_27_get_00_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_00_10_11;
import c_mesh3d_exchange_27_set_00_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_10_11;
import c_mesh3d_exchange_27_get_00_11_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_27_get_00_11_00;
import c_mesh3d_exchange_27_set_00_11_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_11_00;
import c_mesh3d_exchange_27_get_00_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_00_11_01;
import c_mesh3d_exchange_27_set_00_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_11_01;
import c_mesh3d_exchange_27_get_00_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_00_11_10;
import c_mesh3d_exchange_27_set_00_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_11_10;
import c_mesh3d_exchange_27_get_00_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_00_11_11;
import c_mesh3d_exchange_27_set_00_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_00_11_11;
import c_mesh3d_exchange_27_get_01_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_01_00_00;
import c_mesh3d_exchange_27_set_01_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_01_00_00;
import c_mesh3d_exchange_27_get_01_00_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_01_00_01;
import c_mesh3d_exchange_27_set_01_00_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_00_01;
import c_mesh3d_exchange_27_get_01_00_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_01_00_10;
import c_mesh3d_exchange_27_set_01_00_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_00_10;
import c_mesh3d_exchange_27_get_01_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_00_11;
import c_mesh3d_exchange_27_set_01_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_00_11;
import c_mesh3d_exchange_27_get_01_01_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_01_01_00;
import c_mesh3d_exchange_27_set_01_01_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_01_00;
import c_mesh3d_exchange_27_get_01_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_01_01;
import c_mesh3d_exchange_27_set_01_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_01_01;
import c_mesh3d_exchange_27_get_01_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_01_10;
import c_mesh3d_exchange_27_set_01_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_01_10;
import c_mesh3d_exchange_27_get_01_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_01_11;
import c_mesh3d_exchange_27_set_01_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_01_11;
import c_mesh3d_exchange_27_get_01_10_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_01_10_00;
import c_mesh3d_exchange_27_set_01_10_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_10_00;
import c_mesh3d_exchange_27_get_01_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_10_01;
import c_mesh3d_exchange_27_set_01_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_10_01;
import c_mesh3d_exchange_27_get_01_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_10_10;
import c_mesh3d_exchange_27_set_01_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_10_10;
import c_mesh3d_exchange_27_get_01_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_10_11;
import c_mesh3d_exchange_27_set_01_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_10_11;
import c_mesh3d_exchange_27_get_01_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_11_00;
import c_mesh3d_exchange_27_set_01_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_11_00;
import c_mesh3d_exchange_27_get_01_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_11_01;
import c_mesh3d_exchange_27_set_01_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_11_01;
import c_mesh3d_exchange_27_get_01_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_11_10;
import c_mesh3d_exchange_27_set_01_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_11_10;
import c_mesh3d_exchange_27_get_01_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_01_11_11;
import c_mesh3d_exchange_27_set_01_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_01_11_11;
import c_mesh3d_exchange_27_get_10_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_27_get_10_00_00;
import c_mesh3d_exchange_27_set_10_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_27_set_10_00_00;
import c_mesh3d_exchange_27_get_10_00_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_10_00_01;
import c_mesh3d_exchange_27_set_10_00_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_00_01;
import c_mesh3d_exchange_27_get_10_00_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_10_00_10;
import c_mesh3d_exchange_27_set_10_00_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_00_10;
import c_mesh3d_exchange_27_get_10_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_00_11;
import c_mesh3d_exchange_27_set_10_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_00_11;
import c_mesh3d_exchange_27_get_10_01_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_10_01_00;
import c_mesh3d_exchange_27_set_10_01_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_01_00;
import c_mesh3d_exchange_27_get_10_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_01_01;
import c_mesh3d_exchange_27_set_10_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_01_01;
import c_mesh3d_exchange_27_get_10_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_01_10;
import c_mesh3d_exchange_27_set_10_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_01_10;
import c_mesh3d_exchange_27_get_10_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_01_11;
import c_mesh3d_exchange_27_set_10_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_01_11;
import c_mesh3d_exchange_27_get_10_10_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_27_get_10_10_00;
import c_mesh3d_exchange_27_set_10_10_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_10_00;
import c_mesh3d_exchange_27_get_10_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_10_01;
import c_mesh3d_exchange_27_set_10_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_10_01;
import c_mesh3d_exchange_27_get_10_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_10_10;
import c_mesh3d_exchange_27_set_10_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_10_10;
import c_mesh3d_exchange_27_get_10_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_10_11;
import c_mesh3d_exchange_27_set_10_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_10_11;
import c_mesh3d_exchange_27_get_10_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_11_00;
import c_mesh3d_exchange_27_set_10_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_11_00;
import c_mesh3d_exchange_27_get_10_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_11_01;
import c_mesh3d_exchange_27_set_10_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_11_01;
import c_mesh3d_exchange_27_get_10_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_11_10;
import c_mesh3d_exchange_27_set_10_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_11_10;
import c_mesh3d_exchange_27_get_10_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_10_11_11;
import c_mesh3d_exchange_27_set_10_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_10_11_11;
import c_mesh3d_exchange_27_get_11_00_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_27_get_11_00_00;
import c_mesh3d_exchange_27_set_11_00_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_00_00;
import c_mesh3d_exchange_27_get_11_00_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_00_01;
import c_mesh3d_exchange_27_set_11_00_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_00_01;
import c_mesh3d_exchange_27_get_11_00_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_00_10;
import c_mesh3d_exchange_27_set_11_00_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_00_10;
import c_mesh3d_exchange_27_get_11_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_00_11;
import c_mesh3d_exchange_27_set_11_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_00_11;
import c_mesh3d_exchange_27_get_11_01_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_01_00;
import c_mesh3d_exchange_27_set_11_01_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_01_00;
import c_mesh3d_exchange_27_get_11_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_01_01;
import c_mesh3d_exchange_27_set_11_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_01_01;
import c_mesh3d_exchange_27_get_11_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_01_10;
import c_mesh3d_exchange_27_set_11_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_01_10;
import c_mesh3d_exchange_27_get_11_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_01_11;
import c_mesh3d_exchange_27_set_11_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_01_11;
import c_mesh3d_exchange_27_get_11_10_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_10_00;
import c_mesh3d_exchange_27_set_11_10_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_10_00;
import c_mesh3d_exchange_27_get_11_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_10_01;
import c_mesh3d_exchange_27_set_11_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_10_01;
import c_mesh3d_exchange_27_get_11_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_10_10;
import c_mesh3d_exchange_27_set_11_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_10_10;
import c_mesh3d_exchange_27_get_11_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_10_11;
import c_mesh3d_exchange_27_set_11_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_10_11;
import c_mesh3d_exchange_27_get_11_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_11_00;
import c_mesh3d_exchange_27_set_11_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_11_00;
import c_mesh3d_exchange_27_get_11_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_11_01;
import c_mesh3d_exchange_27_set_11_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_11_01;
import c_mesh3d_exchange_27_get_11_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_11_10;
import c_mesh3d_exchange_27_set_11_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_11_10;
import c_mesh3d_exchange_27_get_11_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_27_get_11_11_11;
import c_mesh3d_exchange_27_set_11_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_27_set_11_11_11;

sub mesh3d_exchange111_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf cpy000000[i][k][l]: mesh3d_exchange_27_copy_00_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],  v[i][k][l]);
  }
}

sub mesh3d_exchange112_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_27_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_27_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_27_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_27_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange113_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000011[i][k][l]: mesh3d_exchange_27_get_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set000011[i][k][l]: mesh3d_exchange_27_set_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_27_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_27_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_27_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_27_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange121_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_27_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_27_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_27_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_27_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange122_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange123_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_27_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_27_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_27_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_27_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange131_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001100[i][k][l]: mesh3d_exchange_27_get_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set001100[i][k][l]: mesh3d_exchange_27_set_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_27_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_27_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_27_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_27_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange132_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_27_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_27_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_27_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_27_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange133_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_27_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_27_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get001111[i][k][l]: mesh3d_exchange_27_get_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001111[i][k][l]: mesh3d_exchange_27_set_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_27_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_27_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_27_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_27_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_27_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_27_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange211_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_27_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_27_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_27_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_27_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange212_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange213_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_27_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_27_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_27_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_27_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange221_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange222_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange223_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange231_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_27_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_27_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_27_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_27_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange232_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange233_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_27_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_27_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_27_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_27_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange311_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_27_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_27_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110000[i][k][l]: mesh3d_exchange_27_get_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 22][i][k][l]);
    cf set110000[i][k][l]: mesh3d_exchange_27_set_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_27_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_27_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange312_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_27_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_27_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_27_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_27_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange313_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_27_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_27_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_27_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_27_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110011[i][k][l]: mesh3d_exchange_27_get_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110011[i][k][l]: mesh3d_exchange_27_set_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_27_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_27_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_27_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_27_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange321_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_27_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_27_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_27_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_27_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange322_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange323_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_27_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_27_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_27_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_27_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange331_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_27_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_27_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111100[i][k][l]: mesh3d_exchange_27_get_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set111100[i][k][l]: mesh3d_exchange_27_set_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_27_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_27_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_27_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_27_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_27_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_27_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange332_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_27_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_27_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_27_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_27_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange333_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_27_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_27_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_27_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_27_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_27_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_27_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_27_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_27_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_27_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_27_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_27_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_27_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get111111[i][k][l]: mesh3d_exchange_27_get_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111111[i][k][l]: mesh3d_exchange_27_set_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange_27( name nf,name nfs,name u,  name v)




{
  if (nf[0] == 1)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex111: mesh3d_exchange111_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex112: mesh3d_exchange112_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex113: mesh3d_exchange113_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex121: mesh3d_exchange121_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex122: mesh3d_exchange122_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex123: mesh3d_exchange123_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex131: mesh3d_exchange131_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex132: mesh3d_exchange132_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex133: mesh3d_exchange133_27( nf,nfs,u,  v);
    }
  }
  if (nf[0] == 2)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex211: mesh3d_exchange211_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex212: mesh3d_exchange212_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex213: mesh3d_exchange213_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex221: mesh3d_exchange221_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex222: mesh3d_exchange222_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex223: mesh3d_exchange223_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex231: mesh3d_exchange231_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex232: mesh3d_exchange232_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex233: mesh3d_exchange233_27( nf,nfs,u,  v);
    }
  }
  if (nf[0] >= 3)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex311: mesh3d_exchange311_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex312: mesh3d_exchange312_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex313: mesh3d_exchange313_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex321: mesh3d_exchange321_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex322: mesh3d_exchange322_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex323: mesh3d_exchange323_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex331: mesh3d_exchange331_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex332: mesh3d_exchange332_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex333: mesh3d_exchange333_27( nf,nfs,u,  v);
    }
  }
}


























































import c_mesh3d_exchange_sum_27_copy_00_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_copy_00_00_00;
import c_mesh3d_exchange_sum_27_get_00_00_01( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_00_00_01;
import c_mesh3d_exchange_sum_27_set_00_00_01( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_00_01;
import c_mesh3d_exchange_sum_27_get_00_00_10( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_00_00_10;
import c_mesh3d_exchange_sum_27_set_00_00_10( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_00_10;
import c_mesh3d_exchange_sum_27_get_00_00_11( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_sum_27_get_00_00_11;
import c_mesh3d_exchange_sum_27_set_00_00_11( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_00_11;
import c_mesh3d_exchange_sum_27_get_00_01_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_00_01_00;
import c_mesh3d_exchange_sum_27_set_00_01_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_01_00;
import c_mesh3d_exchange_sum_27_get_00_01_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_00_01_01;
import c_mesh3d_exchange_sum_27_set_00_01_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_01_01;
import c_mesh3d_exchange_sum_27_get_00_01_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_00_01_10;
import c_mesh3d_exchange_sum_27_set_00_01_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_01_10;
import c_mesh3d_exchange_sum_27_get_00_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_00_01_11;
import c_mesh3d_exchange_sum_27_set_00_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_01_11;
import c_mesh3d_exchange_sum_27_get_00_10_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_00_10_00;
import c_mesh3d_exchange_sum_27_set_00_10_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_10_00;
import c_mesh3d_exchange_sum_27_get_00_10_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_00_10_01;
import c_mesh3d_exchange_sum_27_set_00_10_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_10_01;
import c_mesh3d_exchange_sum_27_get_00_10_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_00_10_10;
import c_mesh3d_exchange_sum_27_set_00_10_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_10_10;
import c_mesh3d_exchange_sum_27_get_00_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_00_10_11;
import c_mesh3d_exchange_sum_27_set_00_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_10_11;
import c_mesh3d_exchange_sum_27_get_00_11_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_sum_27_get_00_11_00;
import c_mesh3d_exchange_sum_27_set_00_11_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_11_00;
import c_mesh3d_exchange_sum_27_get_00_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_00_11_01;
import c_mesh3d_exchange_sum_27_set_00_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_11_01;
import c_mesh3d_exchange_sum_27_get_00_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_00_11_10;
import c_mesh3d_exchange_sum_27_set_00_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_11_10;
import c_mesh3d_exchange_sum_27_get_00_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_00_11_11;
import c_mesh3d_exchange_sum_27_set_00_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_00_11_11;
import c_mesh3d_exchange_sum_27_get_01_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_01_00_00;
import c_mesh3d_exchange_sum_27_set_01_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_00_00;
import c_mesh3d_exchange_sum_27_get_01_00_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_01_00_01;
import c_mesh3d_exchange_sum_27_set_01_00_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_00_01;
import c_mesh3d_exchange_sum_27_get_01_00_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_01_00_10;
import c_mesh3d_exchange_sum_27_set_01_00_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_00_10;
import c_mesh3d_exchange_sum_27_get_01_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_00_11;
import c_mesh3d_exchange_sum_27_set_01_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_00_11;
import c_mesh3d_exchange_sum_27_get_01_01_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_01_01_00;
import c_mesh3d_exchange_sum_27_set_01_01_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_01_00;
import c_mesh3d_exchange_sum_27_get_01_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_01_01;
import c_mesh3d_exchange_sum_27_set_01_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_01_01;
import c_mesh3d_exchange_sum_27_get_01_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_01_10;
import c_mesh3d_exchange_sum_27_set_01_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_01_10;
import c_mesh3d_exchange_sum_27_get_01_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_01_11;
import c_mesh3d_exchange_sum_27_set_01_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_01_11;
import c_mesh3d_exchange_sum_27_get_01_10_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_01_10_00;
import c_mesh3d_exchange_sum_27_set_01_10_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_10_00;
import c_mesh3d_exchange_sum_27_get_01_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_10_01;
import c_mesh3d_exchange_sum_27_set_01_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_10_01;
import c_mesh3d_exchange_sum_27_get_01_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_10_10;
import c_mesh3d_exchange_sum_27_set_01_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_10_10;
import c_mesh3d_exchange_sum_27_get_01_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_10_11;
import c_mesh3d_exchange_sum_27_set_01_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_10_11;
import c_mesh3d_exchange_sum_27_get_01_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_11_00;
import c_mesh3d_exchange_sum_27_set_01_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_11_00;
import c_mesh3d_exchange_sum_27_get_01_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_11_01;
import c_mesh3d_exchange_sum_27_set_01_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_11_01;
import c_mesh3d_exchange_sum_27_get_01_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_11_10;
import c_mesh3d_exchange_sum_27_set_01_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_11_10;
import c_mesh3d_exchange_sum_27_get_01_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_01_11_11;
import c_mesh3d_exchange_sum_27_set_01_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_01_11_11;
import c_mesh3d_exchange_sum_27_get_10_00_00( int ,int ,int ,value ,  name ) as mesh3d_exchange_sum_27_get_10_00_00;
import c_mesh3d_exchange_sum_27_set_10_00_00( int ,int ,int ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_00_00;
import c_mesh3d_exchange_sum_27_get_10_00_01( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_10_00_01;
import c_mesh3d_exchange_sum_27_set_10_00_01( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_00_01;
import c_mesh3d_exchange_sum_27_get_10_00_10( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_10_00_10;
import c_mesh3d_exchange_sum_27_set_10_00_10( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_00_10;
import c_mesh3d_exchange_sum_27_get_10_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_00_11;
import c_mesh3d_exchange_sum_27_set_10_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_00_11;
import c_mesh3d_exchange_sum_27_get_10_01_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_10_01_00;
import c_mesh3d_exchange_sum_27_set_10_01_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_01_00;
import c_mesh3d_exchange_sum_27_get_10_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_01_01;
import c_mesh3d_exchange_sum_27_set_10_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_01_01;
import c_mesh3d_exchange_sum_27_get_10_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_01_10;
import c_mesh3d_exchange_sum_27_set_10_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_01_10;
import c_mesh3d_exchange_sum_27_get_10_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_01_11;
import c_mesh3d_exchange_sum_27_set_10_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_01_11;
import c_mesh3d_exchange_sum_27_get_10_10_00( int ,int ,int ,value ,  name ,name ,name ) as mesh3d_exchange_sum_27_get_10_10_00;
import c_mesh3d_exchange_sum_27_set_10_10_00( int ,int ,int ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_10_00;
import c_mesh3d_exchange_sum_27_get_10_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_10_01;
import c_mesh3d_exchange_sum_27_set_10_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_10_01;
import c_mesh3d_exchange_sum_27_get_10_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_10_10;
import c_mesh3d_exchange_sum_27_set_10_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_10_10;
import c_mesh3d_exchange_sum_27_get_10_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_10_11;
import c_mesh3d_exchange_sum_27_set_10_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_10_11;
import c_mesh3d_exchange_sum_27_get_10_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_11_00;
import c_mesh3d_exchange_sum_27_set_10_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_11_00;
import c_mesh3d_exchange_sum_27_get_10_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_11_01;
import c_mesh3d_exchange_sum_27_set_10_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_11_01;
import c_mesh3d_exchange_sum_27_get_10_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_11_10;
import c_mesh3d_exchange_sum_27_set_10_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_11_10;
import c_mesh3d_exchange_sum_27_get_10_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_10_11_11;
import c_mesh3d_exchange_sum_27_set_10_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_10_11_11;
import c_mesh3d_exchange_sum_27_get_11_00_00( int ,int ,int ,value ,  name ,name ) as mesh3d_exchange_sum_27_get_11_00_00;
import c_mesh3d_exchange_sum_27_set_11_00_00( int ,int ,int ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_00_00;
import c_mesh3d_exchange_sum_27_get_11_00_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_00_01;
import c_mesh3d_exchange_sum_27_set_11_00_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_00_01;
import c_mesh3d_exchange_sum_27_get_11_00_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_00_10;
import c_mesh3d_exchange_sum_27_set_11_00_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_00_10;
import c_mesh3d_exchange_sum_27_get_11_00_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_00_11;
import c_mesh3d_exchange_sum_27_set_11_00_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_00_11;
import c_mesh3d_exchange_sum_27_get_11_01_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_01_00;
import c_mesh3d_exchange_sum_27_set_11_01_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_01_00;
import c_mesh3d_exchange_sum_27_get_11_01_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_01_01;
import c_mesh3d_exchange_sum_27_set_11_01_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_01_01;
import c_mesh3d_exchange_sum_27_get_11_01_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_01_10;
import c_mesh3d_exchange_sum_27_set_11_01_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_01_10;
import c_mesh3d_exchange_sum_27_get_11_01_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_01_11;
import c_mesh3d_exchange_sum_27_set_11_01_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_01_11;
import c_mesh3d_exchange_sum_27_get_11_10_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_10_00;
import c_mesh3d_exchange_sum_27_set_11_10_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_10_00;
import c_mesh3d_exchange_sum_27_get_11_10_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_10_01;
import c_mesh3d_exchange_sum_27_set_11_10_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_10_01;
import c_mesh3d_exchange_sum_27_get_11_10_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_10_10;
import c_mesh3d_exchange_sum_27_set_11_10_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_10_10;
import c_mesh3d_exchange_sum_27_get_11_10_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_10_11;
import c_mesh3d_exchange_sum_27_set_11_10_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_10_11;
import c_mesh3d_exchange_sum_27_get_11_11_00( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_11_00;
import c_mesh3d_exchange_sum_27_set_11_11_00( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_11_00;
import c_mesh3d_exchange_sum_27_get_11_11_01( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_11_01;
import c_mesh3d_exchange_sum_27_set_11_11_01( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_11_01;
import c_mesh3d_exchange_sum_27_get_11_11_10( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_11_10;
import c_mesh3d_exchange_sum_27_set_11_11_10( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_11_10;
import c_mesh3d_exchange_sum_27_get_11_11_11( int ,int ,int ,value ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_sum_27_get_11_11_11;
import c_mesh3d_exchange_sum_27_set_11_11_11( int ,int ,int ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ) as mesh3d_exchange_sum_27_set_11_11_11;

sub mesh3d_exchange111_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf cpy000000[i][k][l]: mesh3d_exchange_sum_27_copy_00_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],  v[i][k][l]);
  }
}

sub mesh3d_exchange112_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_sum_27_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_sum_27_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_sum_27_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_sum_27_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange113_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000011[i][k][l]: mesh3d_exchange_sum_27_get_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set000011[i][k][l]: mesh3d_exchange_sum_27_set_00_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_sum_27_get_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_sum_27_set_00_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_sum_27_get_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_sum_27_set_00_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange121_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_sum_27_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_sum_27_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_sum_27_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_sum_27_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange122_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_sum_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_sum_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_sum_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_sum_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_sum_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_sum_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_sum_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_sum_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange123_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_sum_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_sum_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_sum_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_sum_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_sum_27_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_sum_27_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_sum_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_sum_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_sum_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_sum_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_sum_27_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_sum_27_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange131_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001100[i][k][l]: mesh3d_exchange_sum_27_get_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set001100[i][k][l]: mesh3d_exchange_sum_27_set_00_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_sum_27_get_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_sum_27_set_00_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_sum_27_get_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_sum_27_set_00_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange132_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_sum_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_sum_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_sum_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_sum_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_sum_27_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_sum_27_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_sum_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_sum_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_sum_27_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_sum_27_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_sum_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_sum_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange133_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_sum_27_get_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_sum_27_set_00_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_sum_27_get_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_sum_27_set_00_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_sum_27_get_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_sum_27_set_00_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get001111[i][k][l]: mesh3d_exchange_sum_27_get_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001111[i][k][l]: mesh3d_exchange_sum_27_set_00_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_sum_27_get_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_sum_27_set_00_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_sum_27_get_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_sum_27_set_00_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_sum_27_get_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_sum_27_set_00_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_sum_27_get_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_sum_27_set_00_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_sum_27_get_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_sum_27_set_00_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange211_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_sum_27_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_sum_27_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_sum_27_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_sum_27_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange212_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_sum_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_sum_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_sum_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_sum_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_sum_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_sum_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_sum_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_sum_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange213_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_sum_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_sum_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_sum_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_sum_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_sum_27_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_sum_27_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_sum_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_sum_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_sum_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_sum_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_sum_27_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_sum_27_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange221_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_sum_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_sum_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_sum_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_sum_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_sum_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_sum_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_sum_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_sum_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange222_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange223_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_sum_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_sum_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_sum_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_sum_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_sum_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_sum_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_sum_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_sum_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange231_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_sum_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_sum_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_sum_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_sum_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_sum_27_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_sum_27_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_sum_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_sum_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_sum_27_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_sum_27_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_sum_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_sum_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange232_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_sum_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_sum_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_sum_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_sum_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_sum_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_sum_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_sum_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_sum_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange233_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_sum_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_sum_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_sum_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_sum_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_sum_27_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_sum_27_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_sum_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_sum_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_sum_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_sum_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_sum_27_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_sum_27_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_sum_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_sum_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_sum_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_sum_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_sum_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_sum_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_sum_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_sum_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange311_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_sum_27_get_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_sum_27_set_10_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110000[i][k][l]: mesh3d_exchange_sum_27_get_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 22][i][k][l]);
    cf set110000[i][k][l]: mesh3d_exchange_sum_27_set_11_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_sum_27_get_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 22][i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_sum_27_set_01_00_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 4][i+1][k][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange312_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_sum_27_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_sum_27_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_sum_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_sum_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_sum_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_sum_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_sum_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_sum_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_sum_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_sum_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_sum_27_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_sum_27_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange313_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_sum_27_get_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_sum_27_set_11_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_sum_27_get_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_sum_27_set_01_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_sum_27_get_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_sum_27_set_01_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_sum_27_get_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_sum_27_set_01_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_sum_27_get_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_sum_27_set_10_00_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110011[i][k][l]: mesh3d_exchange_sum_27_get_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110011[i][k][l]: mesh3d_exchange_sum_27_set_11_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_sum_27_get_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_sum_27_set_10_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_sum_27_get_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_sum_27_set_11_00_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_sum_27_get_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_sum_27_set_10_00_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange321_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_sum_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_sum_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_sum_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_sum_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_sum_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_sum_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_sum_27_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_sum_27_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_sum_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_sum_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_sum_27_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_sum_27_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange322_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_sum_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_sum_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_sum_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_sum_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_sum_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_sum_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_sum_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_sum_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange323_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_sum_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_sum_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_sum_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_sum_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_sum_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_sum_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_sum_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_sum_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_sum_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_sum_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_sum_27_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_sum_27_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_sum_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_sum_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_sum_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_sum_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_sum_27_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_sum_27_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_sum_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_sum_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange331_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_sum_27_get_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_sum_27_set_01_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_sum_27_get_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_sum_27_set_10_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_sum_27_get_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_sum_27_set_01_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_sum_27_get_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_sum_27_set_10_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111100[i][k][l]: mesh3d_exchange_sum_27_get_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set111100[i][k][l]: mesh3d_exchange_sum_27_set_11_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_sum_27_get_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 16][i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_sum_27_set_10_11_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_sum_27_get_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_sum_27_set_11_10_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_sum_27_get_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_sum_27_set_01_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_sum_27_get_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_sum_27_set_11_01_00( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange332_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_sum_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_sum_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_sum_27_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_sum_27_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_sum_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_sum_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_sum_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_sum_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_sum_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_sum_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_sum_27_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_sum_27_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_sum_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_sum_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_sum_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_sum_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_sum_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_sum_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_sum_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_sum_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
}

sub mesh3d_exchange333_sum_27( name nf,name nfs,name u,  name v)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_sum_27_get_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_sum_27_set_10_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_sum_27_get_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_sum_27_set_01_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_sum_27_get_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_sum_27_set_01_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_sum_27_get_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_sum_27_set_01_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_sum_27_get_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_sum_27_set_11_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_sum_27_get_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_sum_27_set_01_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_sum_27_get_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_sum_27_set_10_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_sum_27_get_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_sum_27_set_11_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_sum_27_get_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_sum_27_set_01_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_sum_27_get_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_sum_27_set_10_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_sum_27_get_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_sum_27_set_10_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_sum_27_get_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_sum_27_set_11_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_sum_27_get_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_sum_27_set_01_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_sum_27_get_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_sum_27_set_10_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_sum_27_get_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_sum_27_set_11_10_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_sum_27_get_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_sum_27_set_10_10_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_sum_27_get_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_sum_27_set_11_11_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_sum_27_get_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_sum_27_set_10_10_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_sum_27_get_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_sum_27_set_11_01_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_sum_27_get_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_sum_27_set_10_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_sum_27_get_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_sum_27_set_11_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_sum_27_get_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_sum_27_set_11_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_sum_27_get_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_sum_27_set_01_01_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_sum_27_get_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_sum_27_set_01_01_01( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_sum_27_get_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_sum_27_set_01_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       v[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_sum_27_get_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_sum_27_set_10_11_10( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       v[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get111111[i][k][l]: mesh3d_exchange_sum_27_get_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]);
    cf set111111[i][k][l]: mesh3d_exchange_sum_27_set_11_11_11( nfs[0][i],nfs[1][k],nfs[2][l],u[i][k][l],
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       v[i][k][l]);
  }
}

sub mesh3d_exchange_sum_27( name nf,name nfs,name u,  name v)




{
  if (nf[0] == 1)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex111: mesh3d_exchange111_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex112: mesh3d_exchange112_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex113: mesh3d_exchange113_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex121: mesh3d_exchange121_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex122: mesh3d_exchange122_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex123: mesh3d_exchange123_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex131: mesh3d_exchange131_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex132: mesh3d_exchange132_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex133: mesh3d_exchange133_sum_27( nf,nfs,u,  v);
    }
  }
  if (nf[0] == 2)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex211: mesh3d_exchange211_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex212: mesh3d_exchange212_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex213: mesh3d_exchange213_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex221: mesh3d_exchange221_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex222: mesh3d_exchange222_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex223: mesh3d_exchange223_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex231: mesh3d_exchange231_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex232: mesh3d_exchange232_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex233: mesh3d_exchange233_sum_27( nf,nfs,u,  v);
    }
  }
  if (nf[0] >= 3)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex311: mesh3d_exchange311_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex312: mesh3d_exchange312_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex313: mesh3d_exchange313_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex321: mesh3d_exchange321_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex322: mesh3d_exchange322_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex323: mesh3d_exchange323_sum_27( nf,nfs,u,  v);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex331: mesh3d_exchange331_sum_27( nf,nfs,u,  v);
      if (nf[2] == 2) cf ex332: mesh3d_exchange332_sum_27( nf,nfs,u,  v);
      if (nf[2] >= 3) cf ex333: mesh3d_exchange333_sum_27( nf,nfs,u,  v);
    }
  }
}


























































import c_mesh3d_exchange_particles_27_copy_00_00_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_copy_00_00_00;
import c_mesh3d_exchange_particles_27_get_00_00_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_00_00_01;
import c_mesh3d_exchange_particles_27_set_00_00_01( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_00_01;
import c_mesh3d_exchange_particles_27_get_00_00_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_00_00_10;
import c_mesh3d_exchange_particles_27_set_00_00_10( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_00_10;
import c_mesh3d_exchange_particles_27_get_00_00_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ) as mesh3d_exchange_particles_27_get_00_00_11;
import c_mesh3d_exchange_particles_27_set_00_00_11( value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_00_11;
import c_mesh3d_exchange_particles_27_get_00_01_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_00_01_00;
import c_mesh3d_exchange_particles_27_set_00_01_00( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_01_00;
import c_mesh3d_exchange_particles_27_get_00_01_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_01_01;
import c_mesh3d_exchange_particles_27_set_00_01_01( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_01_01;
import c_mesh3d_exchange_particles_27_get_00_01_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_01_10;
import c_mesh3d_exchange_particles_27_set_00_01_10( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_01_10;
import c_mesh3d_exchange_particles_27_get_00_01_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_01_11;
import c_mesh3d_exchange_particles_27_set_00_01_11( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_01_11;
import c_mesh3d_exchange_particles_27_get_00_10_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_00_10_00;
import c_mesh3d_exchange_particles_27_set_00_10_00( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_10_00;
import c_mesh3d_exchange_particles_27_get_00_10_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_10_01;
import c_mesh3d_exchange_particles_27_set_00_10_01( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_10_01;
import c_mesh3d_exchange_particles_27_get_00_10_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_10_10;
import c_mesh3d_exchange_particles_27_set_00_10_10( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_10_10;
import c_mesh3d_exchange_particles_27_get_00_10_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_10_11;
import c_mesh3d_exchange_particles_27_set_00_10_11( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_10_11;
import c_mesh3d_exchange_particles_27_get_00_11_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ) as mesh3d_exchange_particles_27_get_00_11_00;
import c_mesh3d_exchange_particles_27_set_00_11_00( value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_11_00;
import c_mesh3d_exchange_particles_27_get_00_11_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_11_01;
import c_mesh3d_exchange_particles_27_set_00_11_01( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_11_01;
import c_mesh3d_exchange_particles_27_get_00_11_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_11_10;
import c_mesh3d_exchange_particles_27_set_00_11_10( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_11_10;
import c_mesh3d_exchange_particles_27_get_00_11_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_00_11_11;
import c_mesh3d_exchange_particles_27_set_00_11_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_00_11_11;
import c_mesh3d_exchange_particles_27_get_01_00_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_01_00_00;
import c_mesh3d_exchange_particles_27_set_01_00_00( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_00_00;
import c_mesh3d_exchange_particles_27_get_01_00_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_00_01;
import c_mesh3d_exchange_particles_27_set_01_00_01( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_00_01;
import c_mesh3d_exchange_particles_27_get_01_00_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_00_10;
import c_mesh3d_exchange_particles_27_set_01_00_10( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_00_10;
import c_mesh3d_exchange_particles_27_get_01_00_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_00_11;
import c_mesh3d_exchange_particles_27_set_01_00_11( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_00_11;
import c_mesh3d_exchange_particles_27_get_01_01_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_01_00;
import c_mesh3d_exchange_particles_27_set_01_01_00( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_01_00;
import c_mesh3d_exchange_particles_27_get_01_01_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_01_01;
import c_mesh3d_exchange_particles_27_set_01_01_01( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_01_01;
import c_mesh3d_exchange_particles_27_get_01_01_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_01_10;
import c_mesh3d_exchange_particles_27_set_01_01_10( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_01_10;
import c_mesh3d_exchange_particles_27_get_01_01_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_01_11;
import c_mesh3d_exchange_particles_27_set_01_01_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_01_11;
import c_mesh3d_exchange_particles_27_get_01_10_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_10_00;
import c_mesh3d_exchange_particles_27_set_01_10_00( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_10_00;
import c_mesh3d_exchange_particles_27_get_01_10_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_10_01;
import c_mesh3d_exchange_particles_27_set_01_10_01( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_10_01;
import c_mesh3d_exchange_particles_27_get_01_10_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_10_10;
import c_mesh3d_exchange_particles_27_set_01_10_10( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_10_10;
import c_mesh3d_exchange_particles_27_get_01_10_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_10_11;
import c_mesh3d_exchange_particles_27_set_01_10_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_10_11;
import c_mesh3d_exchange_particles_27_get_01_11_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_11_00;
import c_mesh3d_exchange_particles_27_set_01_11_00( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_11_00;
import c_mesh3d_exchange_particles_27_get_01_11_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_11_01;
import c_mesh3d_exchange_particles_27_set_01_11_01( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_11_01;
import c_mesh3d_exchange_particles_27_get_01_11_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_11_10;
import c_mesh3d_exchange_particles_27_set_01_11_10( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_11_10;
import c_mesh3d_exchange_particles_27_get_01_11_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_01_11_11;
import c_mesh3d_exchange_particles_27_set_01_11_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_01_11_11;
import c_mesh3d_exchange_particles_27_get_10_00_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ) as mesh3d_exchange_particles_27_get_10_00_00;
import c_mesh3d_exchange_particles_27_set_10_00_00( value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_00_00;
import c_mesh3d_exchange_particles_27_get_10_00_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_00_01;
import c_mesh3d_exchange_particles_27_set_10_00_01( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_00_01;
import c_mesh3d_exchange_particles_27_get_10_00_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_00_10;
import c_mesh3d_exchange_particles_27_set_10_00_10( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_00_10;
import c_mesh3d_exchange_particles_27_get_10_00_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_00_11;
import c_mesh3d_exchange_particles_27_set_10_00_11( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_00_11;
import c_mesh3d_exchange_particles_27_get_10_01_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_01_00;
import c_mesh3d_exchange_particles_27_set_10_01_00( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_01_00;
import c_mesh3d_exchange_particles_27_get_10_01_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_01_01;
import c_mesh3d_exchange_particles_27_set_10_01_01( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_01_01;
import c_mesh3d_exchange_particles_27_get_10_01_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_01_10;
import c_mesh3d_exchange_particles_27_set_10_01_10( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_01_10;
import c_mesh3d_exchange_particles_27_get_10_01_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_01_11;
import c_mesh3d_exchange_particles_27_set_10_01_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_01_11;
import c_mesh3d_exchange_particles_27_get_10_10_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_10_00;
import c_mesh3d_exchange_particles_27_set_10_10_00( value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_10_00;
import c_mesh3d_exchange_particles_27_get_10_10_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_10_01;
import c_mesh3d_exchange_particles_27_set_10_10_01( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_10_01;
import c_mesh3d_exchange_particles_27_get_10_10_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_10_10;
import c_mesh3d_exchange_particles_27_set_10_10_10( value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_10_10;
import c_mesh3d_exchange_particles_27_get_10_10_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_10_11;
import c_mesh3d_exchange_particles_27_set_10_10_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_10_11;
import c_mesh3d_exchange_particles_27_get_10_11_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_11_00;
import c_mesh3d_exchange_particles_27_set_10_11_00( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_11_00;
import c_mesh3d_exchange_particles_27_get_10_11_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_11_01;
import c_mesh3d_exchange_particles_27_set_10_11_01( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_11_01;
import c_mesh3d_exchange_particles_27_get_10_11_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_11_10;
import c_mesh3d_exchange_particles_27_set_10_11_10( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_11_10;
import c_mesh3d_exchange_particles_27_get_10_11_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_10_11_11;
import c_mesh3d_exchange_particles_27_set_10_11_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_10_11_11;
import c_mesh3d_exchange_particles_27_get_11_00_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ) as mesh3d_exchange_particles_27_get_11_00_00;
import c_mesh3d_exchange_particles_27_set_11_00_00( value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_00_00;
import c_mesh3d_exchange_particles_27_get_11_00_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_00_01;
import c_mesh3d_exchange_particles_27_set_11_00_01( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_00_01;
import c_mesh3d_exchange_particles_27_get_11_00_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_00_10;
import c_mesh3d_exchange_particles_27_set_11_00_10( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_00_10;
import c_mesh3d_exchange_particles_27_get_11_00_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_00_11;
import c_mesh3d_exchange_particles_27_set_11_00_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_00_11;
import c_mesh3d_exchange_particles_27_get_11_01_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_01_00;
import c_mesh3d_exchange_particles_27_set_11_01_00( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_01_00;
import c_mesh3d_exchange_particles_27_get_11_01_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_01_01;
import c_mesh3d_exchange_particles_27_set_11_01_01( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_01_01;
import c_mesh3d_exchange_particles_27_get_11_01_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_01_10;
import c_mesh3d_exchange_particles_27_set_11_01_10( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_01_10;
import c_mesh3d_exchange_particles_27_get_11_01_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_01_11;
import c_mesh3d_exchange_particles_27_set_11_01_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_01_11;
import c_mesh3d_exchange_particles_27_get_11_10_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_10_00;
import c_mesh3d_exchange_particles_27_set_11_10_00( value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_10_00;
import c_mesh3d_exchange_particles_27_get_11_10_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_10_01;
import c_mesh3d_exchange_particles_27_set_11_10_01( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_10_01;
import c_mesh3d_exchange_particles_27_get_11_10_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_10_10;
import c_mesh3d_exchange_particles_27_set_11_10_10( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_10_10;
import c_mesh3d_exchange_particles_27_get_11_10_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_10_11;
import c_mesh3d_exchange_particles_27_set_11_10_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_10_11;
import c_mesh3d_exchange_particles_27_get_11_11_00( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_11_00;
import c_mesh3d_exchange_particles_27_set_11_11_00( value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_11_00;
import c_mesh3d_exchange_particles_27_get_11_11_01( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_11_01;
import c_mesh3d_exchange_particles_27_set_11_11_01( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_11_01;
import c_mesh3d_exchange_particles_27_get_11_11_10( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_11_10;
import c_mesh3d_exchange_particles_27_set_11_11_10( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_11_10;
import c_mesh3d_exchange_particles_27_get_11_11_11( int ,value ,real ,real ,real ,real ,real ,real ,  name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ,name ) as mesh3d_exchange_particles_27_get_11_11_11;
import c_mesh3d_exchange_particles_27_set_11_11_11( value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,value ,  name ,name ) as mesh3d_exchange_particles_27_set_11_11_11;

sub mesh3d_exchange111_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf cpy000000[i][k][l]: mesh3d_exchange_particles_27_copy_00_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],  npfsnew[i][k][l],pnew[i][k][l]) >> (used_p[i][k][l]);
  }
}

sub mesh3d_exchange112_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_particles_27_get_00_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_particles_27_set_00_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_particles_27_get_00_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_particles_27_set_00_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange113_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000011[i][k][l]: mesh3d_exchange_particles_27_get_00_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set000011[i][k][l]: mesh3d_exchange_particles_27_set_00_00_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000001[i][k][l]: mesh3d_exchange_particles_27_get_00_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set000001[i][k][l]: mesh3d_exchange_particles_27_set_00_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000010[i][k][l]: mesh3d_exchange_particles_27_get_00_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set000010[i][k][l]: mesh3d_exchange_particles_27_set_00_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange121_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_particles_27_get_00_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_particles_27_set_00_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_particles_27_get_00_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_particles_27_set_00_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange122_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_particles_27_get_00_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_particles_27_set_00_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_particles_27_get_00_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_particles_27_set_00_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_particles_27_get_00_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_particles_27_set_00_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_particles_27_get_00_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_particles_27_set_00_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange123_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_particles_27_get_00_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_particles_27_set_00_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_particles_27_get_00_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_particles_27_set_00_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_particles_27_get_00_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_particles_27_set_00_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_particles_27_get_00_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_particles_27_set_00_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_particles_27_get_00_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_particles_27_set_00_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_particles_27_get_00_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_particles_27_set_00_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange131_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001100[i][k][l]: mesh3d_exchange_particles_27_get_00_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set001100[i][k][l]: mesh3d_exchange_particles_27_set_00_11_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001000[i][k][l]: mesh3d_exchange_particles_27_get_00_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001000[i][k][l]: mesh3d_exchange_particles_27_set_00_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000100[i][k][l]: mesh3d_exchange_particles_27_get_00_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000100[i][k][l]: mesh3d_exchange_particles_27_set_00_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange132_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_particles_27_get_00_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_particles_27_set_00_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_particles_27_get_00_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_particles_27_set_00_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_particles_27_get_00_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_particles_27_set_00_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_particles_27_get_00_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_particles_27_set_00_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_particles_27_get_00_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_particles_27_set_00_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_particles_27_get_00_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_particles_27_set_00_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange133_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get001010[i][k][l]: mesh3d_exchange_particles_27_get_00_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set001010[i][k][l]: mesh3d_exchange_particles_27_set_00_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get001001[i][k][l]: mesh3d_exchange_particles_27_get_00_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001001[i][k][l]: mesh3d_exchange_particles_27_set_00_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get001011[i][k][l]: mesh3d_exchange_particles_27_get_00_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set001011[i][k][l]: mesh3d_exchange_particles_27_set_00_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get001111[i][k][l]: mesh3d_exchange_particles_27_get_00_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set001111[i][k][l]: mesh3d_exchange_particles_27_set_00_11_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get001101[i][k][l]: mesh3d_exchange_particles_27_get_00_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set001101[i][k][l]: mesh3d_exchange_particles_27_set_00_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get000110[i][k][l]: mesh3d_exchange_particles_27_get_00_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set000110[i][k][l]: mesh3d_exchange_particles_27_set_00_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get001110[i][k][l]: mesh3d_exchange_particles_27_get_00_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set001110[i][k][l]: mesh3d_exchange_particles_27_set_00_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get000101[i][k][l]: mesh3d_exchange_particles_27_get_00_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000101[i][k][l]: mesh3d_exchange_particles_27_set_00_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get000111[i][k][l]: mesh3d_exchange_particles_27_get_00_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set000111[i][k][l]: mesh3d_exchange_particles_27_set_00_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange211_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_particles_27_get_10_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_particles_27_set_10_00_00( 
      b[ 22][i-1][k][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_particles_27_get_01_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_particles_27_set_01_00_00( 
      b[ 13][i][k][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange212_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_particles_27_get_01_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_particles_27_set_01_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_particles_27_get_01_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_particles_27_set_01_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_particles_27_get_10_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_particles_27_set_10_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_particles_27_get_10_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_particles_27_set_10_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange213_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_particles_27_get_01_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_particles_27_set_01_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_particles_27_get_01_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_particles_27_set_01_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_particles_27_get_01_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_particles_27_set_01_00_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_particles_27_get_10_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_particles_27_set_10_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_particles_27_get_10_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_particles_27_set_10_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_particles_27_get_10_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_particles_27_set_10_00_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange221_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_particles_27_get_01_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_particles_27_set_01_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_particles_27_get_10_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_particles_27_set_10_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_particles_27_get_10_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_particles_27_set_10_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_particles_27_get_01_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_particles_27_set_01_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange222_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange223_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_particles_27_get_10_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_particles_27_set_10_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_particles_27_get_01_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_particles_27_set_01_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_particles_27_get_10_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_particles_27_set_10_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_particles_27_get_01_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_particles_27_set_01_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange231_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_particles_27_get_01_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_particles_27_set_01_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_particles_27_get_10_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_particles_27_set_10_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_particles_27_get_01_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_particles_27_set_01_11_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_particles_27_get_10_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_particles_27_set_10_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_particles_27_get_10_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_particles_27_set_10_11_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_particles_27_get_01_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_particles_27_set_01_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange232_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_particles_27_get_01_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_particles_27_set_01_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_particles_27_get_10_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_particles_27_set_10_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_particles_27_get_01_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_particles_27_set_01_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_particles_27_get_10_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_particles_27_set_10_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange233_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_particles_27_get_10_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_particles_27_set_10_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_particles_27_get_01_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_particles_27_set_01_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_particles_27_get_01_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_particles_27_set_01_11_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_particles_27_get_01_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_particles_27_set_01_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_particles_27_get_10_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_particles_27_set_10_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_particles_27_get_10_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_particles_27_set_10_11_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_particles_27_get_10_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_particles_27_set_10_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_particles_27_get_01_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_particles_27_set_01_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_particles_27_get_01_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_particles_27_set_01_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_particles_27_get_10_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_particles_27_set_10_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange311_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100000[i][k][l]: mesh3d_exchange_particles_27_get_10_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100000[i][k][l]: mesh3d_exchange_particles_27_set_10_00_00( 
      b[ 22][i-1][k][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110000[i][k][l]: mesh3d_exchange_particles_27_get_11_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 13][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set110000[i][k][l]: mesh3d_exchange_particles_27_set_11_00_00( 
      b[ 22][i-1][k][l],b[ 13][i][k][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010000[i][k][l]: mesh3d_exchange_particles_27_get_01_00_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010000[i][k][l]: mesh3d_exchange_particles_27_set_01_00_00( 
      b[ 13][i][k][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange312_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_particles_27_get_11_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_particles_27_set_11_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_particles_27_get_01_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_particles_27_set_01_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_particles_27_get_01_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_particles_27_set_01_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_particles_27_get_10_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_particles_27_set_10_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_particles_27_get_10_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_particles_27_set_10_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_particles_27_get_11_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_particles_27_set_11_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange313_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110010[i][k][l]: mesh3d_exchange_particles_27_get_11_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set110010[i][k][l]: mesh3d_exchange_particles_27_set_11_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010010[i][k][l]: mesh3d_exchange_particles_27_get_01_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set010010[i][k][l]: mesh3d_exchange_particles_27_set_01_00_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010001[i][k][l]: mesh3d_exchange_particles_27_get_01_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010001[i][k][l]: mesh3d_exchange_particles_27_set_01_00_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010011[i][k][l]: mesh3d_exchange_particles_27_get_01_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set010011[i][k][l]: mesh3d_exchange_particles_27_set_01_00_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100010[i][k][l]: mesh3d_exchange_particles_27_get_10_00_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set100010[i][k][l]: mesh3d_exchange_particles_27_set_10_00_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110011[i][k][l]: mesh3d_exchange_particles_27_get_11_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set110011[i][k][l]: mesh3d_exchange_particles_27_set_11_00_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100001[i][k][l]: mesh3d_exchange_particles_27_get_10_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100001[i][k][l]: mesh3d_exchange_particles_27_set_10_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110001[i][k][l]: mesh3d_exchange_particles_27_get_11_00_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set110001[i][k][l]: mesh3d_exchange_particles_27_set_11_00_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100011[i][k][l]: mesh3d_exchange_particles_27_get_10_00_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set100011[i][k][l]: mesh3d_exchange_particles_27_set_10_00_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange321_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_particles_27_get_01_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_particles_27_set_01_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_particles_27_get_10_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_particles_27_set_10_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_particles_27_get_10_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_particles_27_set_10_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_particles_27_get_11_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_particles_27_set_11_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_particles_27_get_01_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_particles_27_set_01_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_particles_27_get_11_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_particles_27_set_11_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange322_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_particles_27_get_11_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_particles_27_set_11_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_particles_27_get_11_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_particles_27_set_11_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_particles_27_get_11_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_particles_27_set_11_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_particles_27_get_11_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_particles_27_set_11_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange323_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_particles_27_get_10_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_particles_27_set_10_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_particles_27_get_01_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_particles_27_set_01_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_particles_27_get_11_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_particles_27_set_11_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_particles_27_get_11_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_particles_27_set_11_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_particles_27_get_10_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_particles_27_set_10_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_particles_27_get_11_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_particles_27_set_11_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_particles_27_get_11_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_particles_27_set_11_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_particles_27_get_11_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_particles_27_set_11_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_particles_27_get_11_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_particles_27_set_11_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_particles_27_get_01_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_particles_27_set_01_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange331_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011000[i][k][l]: mesh3d_exchange_particles_27_get_01_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011000[i][k][l]: mesh3d_exchange_particles_27_set_01_10_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100100[i][k][l]: mesh3d_exchange_particles_27_get_10_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100100[i][k][l]: mesh3d_exchange_particles_27_set_10_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011100[i][k][l]: mesh3d_exchange_particles_27_get_01_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011100[i][k][l]: mesh3d_exchange_particles_27_set_01_11_00( 
      b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101000[i][k][l]: mesh3d_exchange_particles_27_get_10_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101000[i][k][l]: mesh3d_exchange_particles_27_set_10_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111100[i][k][l]: mesh3d_exchange_particles_27_get_11_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set111100[i][k][l]: mesh3d_exchange_particles_27_set_11_11_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101100[i][k][l]: mesh3d_exchange_particles_27_get_10_11_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 7][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101100[i][k][l]: mesh3d_exchange_particles_27_set_10_11_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111000[i][k][l]: mesh3d_exchange_particles_27_get_11_10_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 4][i][k][l],b[ 10][i][k][l],b[ 13][i][k][l],b[ 19][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111000[i][k][l]: mesh3d_exchange_particles_27_set_11_10_00( 
      b[ 25][i-1][k-1][l],b[ 22][i-1][k][l],b[ 16][i][k-1][l],b[ 13][i][k][l],b[ 7][i+1][k-1][l],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010100[i][k][l]: mesh3d_exchange_particles_27_get_01_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010100[i][k][l]: mesh3d_exchange_particles_27_set_01_01_00( 
      b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110100[i][k][l]: mesh3d_exchange_particles_27_get_11_01_00( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 7][i][k][l],b[ 13][i][k][l],b[ 16][i][k][l],b[ 22][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110100[i][k][l]: mesh3d_exchange_particles_27_set_11_01_00( 
      b[ 22][i-1][k][l],b[ 19][i-1][k+1][l],b[ 13][i][k][l],b[ 10][i][k+1][l],b[ 4][i+1][k][l],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange332_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_particles_27_get_01_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_particles_27_set_01_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_particles_27_get_11_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_particles_27_set_11_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_particles_27_get_10_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_particles_27_set_10_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_particles_27_get_11_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_particles_27_set_11_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_particles_27_get_11_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_particles_27_set_11_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_particles_27_get_11_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_particles_27_set_11_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_particles_27_get_11_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_particles_27_set_11_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_particles_27_get_11_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_particles_27_set_11_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_particles_27_get_01_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_particles_27_set_01_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_particles_27_get_10_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_particles_27_set_10_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange333_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)
{ df b; 
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=1..nf[2]-2
  {
    cf get100111[i][k][l]: mesh3d_exchange_particles_27_get_10_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100111[i][k][l]: mesh3d_exchange_particles_27_set_10_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get010110[i][k][l]: mesh3d_exchange_particles_27_get_01_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set010110[i][k][l]: mesh3d_exchange_particles_27_set_01_01_10( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=0..0
  {
    cf get011101[i][k][l]: mesh3d_exchange_particles_27_get_01_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011101[i][k][l]: mesh3d_exchange_particles_27_set_01_11_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get011111[i][k][l]: mesh3d_exchange_particles_27_get_01_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set011111[i][k][l]: mesh3d_exchange_particles_27_set_01_11_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get111110[i][k][l]: mesh3d_exchange_particles_27_get_11_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set111110[i][k][l]: mesh3d_exchange_particles_27_set_11_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get011011[i][k][l]: mesh3d_exchange_particles_27_get_01_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011011[i][k][l]: mesh3d_exchange_particles_27_set_01_10_11( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=0..0
  {
    cf get101101[i][k][l]: mesh3d_exchange_particles_27_get_10_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101101[i][k][l]: mesh3d_exchange_particles_27_set_10_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get111010[i][k][l]: mesh3d_exchange_particles_27_get_11_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set111010[i][k][l]: mesh3d_exchange_particles_27_set_11_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get011001[i][k][l]: mesh3d_exchange_particles_27_get_01_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set011001[i][k][l]: mesh3d_exchange_particles_27_set_01_10_01( 
      b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get101111[i][k][l]: mesh3d_exchange_particles_27_get_10_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set101111[i][k][l]: mesh3d_exchange_particles_27_set_10_11_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get100110[i][k][l]: mesh3d_exchange_particles_27_get_10_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set100110[i][k][l]: mesh3d_exchange_particles_27_set_10_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get111001[i][k][l]: mesh3d_exchange_particles_27_get_11_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111001[i][k][l]: mesh3d_exchange_particles_27_set_11_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get011010[i][k][l]: mesh3d_exchange_particles_27_get_01_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l]) >> (used_p[i][k][l]);
    cf set011010[i][k][l]: mesh3d_exchange_particles_27_set_01_10_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get101011[i][k][l]: mesh3d_exchange_particles_27_get_10_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101011[i][k][l]: mesh3d_exchange_particles_27_set_10_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=nf[1]-1..nf[1]-1 for l=1..nf[2]-2
  {
    cf get111011[i][k][l]: mesh3d_exchange_particles_27_get_11_10_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l]) >> (used_p[i][k][l]);
    cf set111011[i][k][l]: mesh3d_exchange_particles_27_set_11_10_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=0..0
  {
    cf get101001[i][k][l]: mesh3d_exchange_particles_27_get_10_10_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l]) >> (used_p[i][k][l]);
    cf set101001[i][k][l]: mesh3d_exchange_particles_27_set_10_10_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=0..0
  {
    cf get111101[i][k][l]: mesh3d_exchange_particles_27_get_11_11_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 1][i][k][l],b[ 2][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set111101[i][k][l]: mesh3d_exchange_particles_27_set_11_11_01( 
      b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=nf[1]-1..nf[1]-1 for l=nf[2]-1..nf[2]-1
  {
    cf get101010[i][k][l]: mesh3d_exchange_particles_27_get_10_10_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l]) >> (used_p[i][k][l]);
    cf set101010[i][k][l]: mesh3d_exchange_particles_27_set_10_10_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=nf[2]-1..nf[2]-1
  {
    cf get110110[i][k][l]: mesh3d_exchange_particles_27_get_11_01_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set110110[i][k][l]: mesh3d_exchange_particles_27_set_11_01_10( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=0..0 for l=0..0
  {
    cf get100101[i][k][l]: mesh3d_exchange_particles_27_get_10_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l]) >> (used_p[i][k][l]);
    cf set100101[i][k][l]: mesh3d_exchange_particles_27_set_10_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=0..0
  {
    cf get110101[i][k][l]: mesh3d_exchange_particles_27_get_11_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 4][i][k][l],b[ 5][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110101[i][k][l]: mesh3d_exchange_particles_27_set_11_01_01( 
      b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=0..0 for l=1..nf[2]-2
  {
    cf get110111[i][k][l]: mesh3d_exchange_particles_27_get_11_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set110111[i][k][l]: mesh3d_exchange_particles_27_set_11_01_11( 
      b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=1..nf[2]-2
  {
    cf get010111[i][k][l]: mesh3d_exchange_particles_27_get_01_01_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010111[i][k][l]: mesh3d_exchange_particles_27_set_01_01_11( 
      b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=0..0 for l=0..0
  {
    cf get010101[i][k][l]: mesh3d_exchange_particles_27_get_01_01_01( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 13][i][k][l],b[ 14][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set010101[i][k][l]: mesh3d_exchange_particles_27_set_01_01_01( 
      b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=0..0 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get011110[i][k][l]: mesh3d_exchange_particles_27_get_01_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l]) >> (used_p[i][k][l]);
    cf set011110[i][k][l]: mesh3d_exchange_particles_27_set_01_11_10( 
      b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=nf[0]-1..nf[0]-1 for k=1..nf[1]-2 for l=nf[2]-1..nf[2]-1
  {
    cf get101110[i][k][l]: mesh3d_exchange_particles_27_get_10_11_10( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l]) >> (used_p[i][k][l]);
    cf set101110[i][k][l]: mesh3d_exchange_particles_27_set_10_11_10( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
  for i=1..nf[0]-2 for k=1..nf[1]-2 for l=1..nf[2]-2
  {
    cf get111111[i][k][l]: mesh3d_exchange_particles_27_get_11_11_11( npfs[i][k][l],p[i][k][l],xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],
       b[ 0][i][k][l],b[ 1][i][k][l],b[ 2][i][k][l],b[ 3][i][k][l],b[ 4][i][k][l],b[ 5][i][k][l],b[ 6][i][k][l],b[ 7][i][k][l],b[ 8][i][k][l],b[ 9][i][k][l],b[ 10][i][k][l],b[ 11][i][k][l],b[ 12][i][k][l],b[ 13][i][k][l],b[ 14][i][k][l],b[ 15][i][k][l],b[ 16][i][k][l],b[ 17][i][k][l],b[ 18][i][k][l],b[ 19][i][k][l],b[ 20][i][k][l],b[ 21][i][k][l],b[ 22][i][k][l],b[ 23][i][k][l],b[ 24][i][k][l],b[ 25][i][k][l],b[ 26][i][k][l]) >> (used_p[i][k][l]);
    cf set111111[i][k][l]: mesh3d_exchange_particles_27_set_11_11_11( 
      b[ 26][i-1][k-1][l-1],b[ 25][i-1][k-1][l],b[ 24][i-1][k-1][l+1],b[ 23][i-1][k][l-1],b[ 22][i-1][k][l],b[ 21][i-1][k][l+1],b[ 20][i-1][k+1][l-1],b[ 19][i-1][k+1][l],b[ 18][i-1][k+1][l+1],b[ 17][i][k-1][l-1],b[ 16][i][k-1][l],b[ 15][i][k-1][l+1],b[ 14][i][k][l-1],b[ 13][i][k][l],b[ 12][i][k][l+1],b[ 11][i][k+1][l-1],b[ 10][i][k+1][l],b[ 9][i][k+1][l+1],b[ 8][i+1][k-1][l-1],b[ 7][i+1][k-1][l],b[ 6][i+1][k-1][l+1],b[ 5][i+1][k][l-1],b[ 4][i+1][k][l],b[ 3][i+1][k][l+1],b[ 2][i+1][k+1][l-1],b[ 1][i+1][k+1][l],b[ 0][i+1][k+1][l+1],
       npfsnew[i][k][l],pnew[i][k][l]);
  }
}

sub mesh3d_exchange_particles_27( name nf,name npfs,name p,name xf1,name xf2,  name npfsnew,name pnew,  name used_p)





{
  if (nf[0] == 1)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex111: mesh3d_exchange111_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex112: mesh3d_exchange112_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex113: mesh3d_exchange113_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex121: mesh3d_exchange121_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex122: mesh3d_exchange122_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex123: mesh3d_exchange123_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex131: mesh3d_exchange131_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex132: mesh3d_exchange132_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex133: mesh3d_exchange133_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
  }
  if (nf[0] == 2)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex211: mesh3d_exchange211_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex212: mesh3d_exchange212_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex213: mesh3d_exchange213_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex221: mesh3d_exchange221_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex222: mesh3d_exchange222_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex223: mesh3d_exchange223_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex231: mesh3d_exchange231_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex232: mesh3d_exchange232_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex233: mesh3d_exchange233_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
  }
  if (nf[0] >= 3)
  {
    if (nf[1] == 1)
    {
      if (nf[2] == 1) cf ex311: mesh3d_exchange311_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex312: mesh3d_exchange312_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex313: mesh3d_exchange313_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] == 2)
    {
      if (nf[2] == 1) cf ex321: mesh3d_exchange321_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex322: mesh3d_exchange322_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex323: mesh3d_exchange323_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
    if (nf[1] >= 3)
    {
      if (nf[2] == 1) cf ex331: mesh3d_exchange331_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] == 2) cf ex332: mesh3d_exchange332_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
      if (nf[2] >= 3) cf ex333: mesh3d_exchange333_particles_27( nf,npfs,p,xf1,xf2,  npfsnew,pnew,  used_p);
    }
  }
}







































import c_print_memory_usage() as print_memory_usage;
import c_ready_print_memory_usage( value ) as ready_print_memory_usage;



import c_print_one_particle( string ,int ,value ) as print_one_particle;





import c_check_file( string ,  name ) as check_file;

import c_read_parameters( string ,  name ,name ,name ,
         name ,name ,name ,       name ,name ,name ,
         name ,name ,name ,       name ,name ,name ,
         name ,name ,name ,name ,    name ,name , name ) as read_parameters;

import c_print_parameters( int ,int ,int ,
                        int ,int ,int ,
                        int ,int ,int ,
                        real ,real ,real ,
                        real ,real ,real ,
                        real ,real ,real ,real ,
                        real ,real ) as print_parameters;

import c_print_parameters_seq( int ,int ,int ,
                        int ,int ,int ,
                        int ,int ,int ,
                        real ,real ,real ,
                        real ,real ,real ,
                        real ,real ,real ,real ,
                        real ,real , value ,  name ) as print_parameters_seq;

sub init_parameters( string args,  name nt,name nts0,name np0,
                 name n, name nf, name xn, name tau,name pm,name sm,
                 name r0, name dv, name eps,name wp)













{
  df filename,file_ok,seqp;
  
  cf chkfle0: check_file( args,  file_ok[0]);
  if (file_ok[0]!=0) 
  { cf cpfn1: assign_string( args,  filename);
    cf prnfn1: puts_seq("Using parameter file '"+filename+"'",file_ok[0],seqp[1]);
    cf cpfok: copy( file_ok[0],  file_ok[1]);
  }
  
  if (file_ok[0]==0)
  { if (args != "") cf prn0: puts_seq("Warning! Can't read provided parameter file '"+args+"'",file_ok[0],seqp[0]);
    if (args == "") cf cpsq0: copy( file_ok[0],  seqp[0]);
    cf cpfn0: assign_string( "pic3d.par",  filename);
    cf chkfle1: check_file( filename,  file_ok[1]);
    if (file_ok[1]!=0) cf prn1: puts_seq("Using default parameter file '"+filename+"'",seqp[0],seqp[1]);
    if (file_ok[1]==0) cf cpsq1: copy( seqp[0],  seqp[1]);
  }
  
  if (file_ok[0]!=0 || file_ok[1]!=0)
  { df read_ok;
    cf readpar: read_parameters( filename,  nt,nts0,np0, n[0],n[1],n[2], nf[0],nf[1],nf[2], xn[0],xn[1],xn[2], tau,pm,sm,r0, dv[0],dv[1],dv[2], eps,wp, read_ok);
    if (read_ok==0) cf prnfn0: puts_seq("Reading parameters from file '"+filename+"' failed!",seqp[1],  seqp[2]);
    if (read_ok!=0) cf cp: copy( seqp[1],  seqp[2]);
  }
  
  if (file_ok[0]==0 && file_ok[1]==0)
  { puts_seq("No default parameter file provided! Using default parameters.",seqp[1],  seqp[2]);

    cf init_nt: assign_int( 10,  nt);
    cf init_nts: assign_int( 1,  nts0);
    cf init_n0: assign_int( 100,  n[0]);
    cf init_n1: assign_int( 100,  n[1]);
    cf init_n2: assign_int( 100,  n[2]);
    cf init_nf0: assign_int( 1,  nf[0]);
    cf init_nf1: assign_int( 1,  nf[1]);
    cf init_nf2: assign_int( 1,  nf[2]);
    cf init_np0: assign_int( 100000,  np0);

    cf inti_xn0: assign_real( 1.0,  xn[0]);
    cf inti_xn1: assign_real( 1.0,  xn[1]);
    cf inti_xn2: assign_real( 1.0,  xn[2]);
    cf init_tau: assign_real( 0.001,  tau);
    cf init_pm:  assign_real( 1.0,  pm);
    cf init_sm:  assign_real( 0.0,  sm);
    cf init_r0:  assign_real( 0.2,  r0);
    cf init_dvr: assign_real( 0.0,  dv[0]);
    cf init_dvf: assign_real( 0.0,  dv[1]);
    cf init_dvz: assign_real( 0.0,  dv[2]);
    cf init_eps: assign_real( 0.001,  eps);
    cf init_wp:  assign_real( 1.8,  wp);
  }
}





sub init_subdomains_parameters( int nf,name nfs,name nf0,real h,  name xf1,name xf2)






{
  for i=0..nf-1
  { cf init_xf1: assign_real( (nf0[i]+1)*h,  xf1[i]);
    cf init_xf2: assign_real( (nf0[i]+nfs[i]-1)*h,  xf2[i]);
  }
}

sub print_subdomains_parameters_seq( int nf,name xf1,name xf2,name prev,  name next)
{ df seq;
  assign(prev,seq[0]);
  for i=0..nf-1 printf_seq("("+xf1[i]+" - "+xf2[i]+")",seq[i],seq[i+1]);
  printf_seq("\n",seq[nf],next);
}

sub print_xyz_seq( name nf,name nfs,name nf0,name h,name prev,  name next)




{
  df seq;
  cf prn0: assign( prev,  seq[0]);
  for i=0..nf[0]-1 cf prnx: print_x_seq( i,nfs[0][i],nf0[0][i],h[0],seq[i],  seq[i+1]);
  for k=0..nf[1]-1 cf prny: print_y_seq( k,nfs[1][k],nf0[1][k],h[1],seq[nf[0]+k],  seq[nf[0]+k+1]);
  for l=0..nf[2]-1 cf prnz: print_z_seq( l,nfs[2][l],nf0[2][l],h[2],seq[nf[0]+nf[1]+l],  seq[nf[0]+nf[1]+l+1]);
  cf prn1: assign( seq[nf[0]+nf[1]+nf[2]],  next);
}




import c_init_particles_full_subdomain( int ,real ,real ,real ,real ,real ,real ,  name ,name ) as init_particles_full_subdomain;
import c_init_particles_circle_xy_subdomain( int ,int kind,real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,  name ,name ) as init_particles_circle_xy_subdomain;
import c_init_particles_circle_xz_subdomain( int ,int kind,real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,  name ,name ) as init_particles_circle_xz_subdomain;
import c_init_particles_circle_yz_subdomain( int ,int kind,real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,  name ,name ) as init_particles_circle_yz_subdomain;
import c_init_particles_ball_subdomain( int ,int kind,real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,  name ,name ) as init_particles_ball_subdomain;

import c_init_particles_velocity_z_subdomain( int ,int ,int ,int ,int ,int ,
  real ,real ,real ,real ,real ,real ,real ,real ,real ,int ,real ,real ,
  value ,value ,value ,value ,int ,value ,  name ) as init_particles_velocity_z_subdomain;
import c_init_particles_velocity_y_subdomain( int ,int ,int ,int ,int ,int ,
  real ,real ,real ,real ,real ,real ,real ,real ,real ,int ,real ,real ,
  value ,value ,value ,value ,int ,value ,  name ) as init_particles_velocity_y_subdomain;
import c_init_particles_velocity_x_subdomain( int ,int ,int ,int ,int ,int ,
  real ,real ,real ,real ,real ,real ,real ,real ,real ,int ,real ,real ,
  value ,value ,value ,value ,int ,value ,  name ) as init_particles_velocity_x_subdomain;

import c_init_particles_velocity_ball_subdomain( int ,int ,int ,int ,int ,int ,
  real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,real ,
  value ,value ,value ,value ,int ,value ,  name ) as init_particles_velocity_ball_subdomain;



sub init_particles_full( int np0,name nf,name xf1,name xf2,  name p,name npfs,name np)







{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf fill: init_particles_full_subdomain( np0,xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],  p[i][k][l],npfs[i][k][l]);
  array3d_int_reduce_sum_int( nf,npfs,  np);
}

sub init_particles_circle_xy( int np0,int kind,name nf,name xf1,name xf2,name cx,real r0,  name p,name npfs,name np)










{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf fill: init_particles_circle_xy_subdomain( np0,kind,xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],cx[0],cx[1],cx[2],r0,
                                                 p[i][k][l],npfs[i][k][l]);
  array3d_int_reduce_sum_int( nf,npfs,  np);
}

sub init_particles_circle_xz( int np0,int kind,name nf,name xf1,name xf2,name cx,real r0,  name p,name npfs,name np)










{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf fill: init_particles_circle_xz_subdomain( np0,kind,xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],cx[0],cx[1],cx[2],r0,
                                                 p[i][k][l],npfs[i][k][l]);
  array3d_int_reduce_sum_int( nf,npfs,  np);
}

sub init_particles_circle_yz( int np0,int kind,name nf,name xf1,name xf2,name cx,real r0,  name p,name npfs,name np)










{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf fill: init_particles_circle_yz_subdomain( np0,kind,xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],cx[0],cx[1],cx[2],r0,
                                                 p[i][k][l],npfs[i][k][l]);
  array3d_int_reduce_sum_int( nf,npfs,  np);
}

sub init_particles_ball( int np0,int kind,name nf,name xf1,name xf2,name cx,real r0,  name p,name npfs,name np)










{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf fill: init_particles_ball_subdomain( np0,kind,xf1[0][i],xf1[1][k],xf1[2][l],xf2[0][i],xf2[1][k],xf2[2][l],cx[0],cx[1],cx[2],r0,
                                              p[i][k][l],npfs[i][k][l]);
  array3d_int_reduce_sum_int( nf,npfs,  np);
}

sub init_particles_velocity_z( name nf,name nfs,name nf0,name h,name cx,name dv,int wave,real tau,name fi,name fx,name fy,name fz,name p,name npfs,  name p_new,  name used_fi,name used_fxyz,name used_p)













{
  df seq,
     emax0, 
     emax;  
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf maxikl: real1d_reduce_max( nfs[0][i]*nfs[1][k]*nfs[2][l],fi[i][k][l],  emax0[i][k][l]);
  cf max3d: array3d_real_reduce_max_real( nf,emax0,  emax);

  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf initpv: init_particles_velocity_z_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                 h[0],h[1],h[2],cx[0],cx[1],cx[2],dv[0],dv[1],dv[2],wave,tau,emax,
                 fx[i][k][l],fy[i][k][l],fz[i][k][l],fi[i][k][l],npfs[i][k][l],p[i][k][l],  p_new[i][k][l]) >> (used_fi[i][k][l],used_fxyz[i][k][l],used_p[i][k][l]);
}

sub init_particles_velocity_y( name nf,name nfs,name nf0,name h,name cx,name dv,int wave,real tau,name fi,name fx,name fy,name fz,name p,name npfs,  name p_new,  name used_fi,name used_fxyz,name used_p)













{
  df seq,
     emax0, 
     emax;  
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf maxikl: real1d_reduce_max( nfs[0][i]*nfs[1][k]*nfs[2][l],fi[i][k][l],  emax0[i][k][l]);
  cf max3d: array3d_real_reduce_max_real( nf,emax0,  emax);

  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf initpv: init_particles_velocity_y_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                 h[0],h[1],h[2],cx[0],cx[1],cx[2],dv[0],dv[1],dv[2],wave,tau,emax,
                 fx[i][k][l],fy[i][k][l],fz[i][k][l],fi[i][k][l],npfs[i][k][l],p[i][k][l],  p_new[i][k][l]) >> (used_fi[i][k][l],used_fxyz[i][k][l],used_p[i][k][l]);
}

sub init_particles_velocity_x( name nf,name nfs,name nf0,name h,name cx,name dv,int wave,real tau,name fi,name fx,name fy,name fz,name p,name npfs,  name p_new,  name used_fi,name used_fxyz,name used_p)













{
  df seq,
     emax0, 
     emax;  
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf maxikl: real1d_reduce_max( nfs[0][i]*nfs[1][k]*nfs[2][l],fi[i][k][l],  emax0[i][k][l]);
  cf max3d: array3d_real_reduce_max_real( nf,emax0,  emax);

  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf initpv: init_particles_velocity_x_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                 h[0],h[1],h[2],cx[0],cx[1],cx[2],dv[0],dv[1],dv[2],wave,tau,emax,
                 fx[i][k][l],fy[i][k][l],fz[i][k][l],fi[i][k][l],npfs[i][k][l],p[i][k][l],  p_new[i][k][l]) >> (used_fi[i][k][l],used_fxyz[i][k][l],used_p[i][k][l]);
}

sub init_particles_velocity_ball( name nf,name nfs,name nf0,name h,name cx,name dv,real tau,name fi,name fx,name fy,name fz,name p,name npfs,  name p_new,  name used_fi,name used_fxyz,name used_p)












{
  df 
     emax0, 
     emax;  
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf maxikl: real1d_reduce_max( nfs[0][i]*nfs[1][k]*nfs[2][l],fi[i][k][l],  emax0[i][k][l]);
  cf max3d: array3d_real_reduce_max_real( nf,emax0,  emax);

  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf initpv: init_particles_velocity_ball_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                 h[0],h[1],h[2],cx[0],cx[1],cx[2],dv[0],dv[1],dv[2],tau,emax,
                 fx[i][k][l],fy[i][k][l],fz[i][k][l],fi[i][k][l],npfs[i][k][l],p[i][k][l],  p_new[i][k][l]) >> (used_fi[i][k][l],used_fxyz[i][k][l],used_p[i][k][l]);
}


sub print_particles_seq( name nf,name p,name npfs,name prev,  name next)
{ df seq;
  assign(prev,seq[0]);
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 let ikl=i*nf[1]*nf[2]+k*nf[2]+l puts_seq("np["+i+"]["+k+"]["+l+"]: "+npfs[i][k][l],seq[ikl],seq[ikl+1]);
  assign(seq[nf[0]*nf[1]*nf[2]],next);
}





import c_init_array3d_subdomain( int ,int ,int ,int ,int ,int ,real ,real ,real ,  name ) as init_array3d_subdomain;
import c_density_subdomain( int ,int ,int ,int ,int ,int ,real ,real ,real ,real ,value ,int ,  name ) as density_subdomain;

import c_init_fi_subdomain( int ,int ,int ,int ,int ,int ,
              int ,int ,int ,int ,int ,int ,
              real ,real ,real ,real ,real ,real ,real ,  name ) as init_fi_subdomain;

import c_fi_dobavka_subdomain( int ,int ,int ,int ,int ,int ,
                                  int ,int ,int ,int ,int ,int ,real ,real ,real ,real ,real ,real ,real ,value ,  name ) as fi_dobavka_subdomain;

import c_force_subdomain( int ,int ,int ,real ,real ,real ,value ,  name ,name ,name ) as force_subdomain;

import c_move_particles_subdomain( int ,int ,int ,int ,int ,int ,real ,real ,real ,
              value ,value ,value ,real ,int ,value ,  name ) as move_particles_subdomain;

sub init_array3d( name nf,name nfs,name nf0,name h,  name u)





{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf init_e: init_array3d_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],h[0],h[1],h[2],  u[i][k][l]);
}

sub density( name nf,name nfs,name nf0,name h,real am,name p,name npfs,  name ro,name used_p)








{
  df ro0; 
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf dens: density_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],h[0],h[1],h[2],am,p[i][k][l],npfs[i][k][l],  ro0[i][k][l]) >> (used_p[i][k][l]);
  cf dex: mesh3d_exchange_sum_27( nf,nfs,ro0,  ro);
}

sub move_particles( name nf,name nfs,name nf0,name h,name xf1,name xf2,name fx,name fy,name fz,real tau,name npfs,name p,  name npfsnew,name pnew,name used_fxyz,name used_p)












{
  df pt; 
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf move: move_particles_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],h[0],h[1],h[2],
               fx[i][k][l],fy[i][k][l],fz[i][k][l],tau,npfs[i][k][l],p[i][k][l],  pt[i][k][l]) >> (used_fxyz[i][k][l]);
  cf pex: mesh3d_exchange_particles_27( nf,npfs,pt,xf1,xf2,  npfsnew,pnew,  used_p);
}

sub init_poisson( name nf,name nfs,name nf0,name h,name cx,real mass,  name fi)







{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf init_fi: init_fi_subdomain( nf[0],nf[1],nf[2],i,k,l,nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                                      h[0],h[1],h[2],cx[0],cx[1],cx[2],mass,  fi[i][k][l]);
}

sub fi_dobavka( name nf,name nfs,name nf0,name h,name cx,real sm,name fp,  name fi,  name used_fp)








{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf init_fi: fi_dobavka_subdomain( nf[0],nf[1],nf[1],i,k,l,
                                      nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],
                                      h[0],h[1],h[2],cx[0],cx[1],cx[2],sm,fp[i][k][l],  fi[i][k][l]) >> (used_fp[i][k][l]);
}

sub force( name nf,name nfs,name h,name fi,  name fx,name fy,name fz,  name used_fi)





{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf frc: force_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],h[0],h[1],h[2],fi[i][k][l],  fx[i][k][l],fy[i][k][l],fz[i][k][l]) >> (used_fi[i][k][l]);
}





import c_get_properties_subdomain( int ,int ,int ,int ,int ,int ,real ,real ,real ,
         real ,real ,real ,real ,value ,value ,int ,  name ) as get_properties_subdomain;
import c_get_properties_finish( real ,real ,value ,  name ) as get_properties_finish;
import c_print_properties_seq( string ,value ,int ,real ,real ,real ,value ,  name ) as print_properties_seq;






sub get_properties( name nf,name nfs,name nf0,name h,name cx,real am,real pm,real sm,name fi,name p,name npfs,  name prop,  name used_fi,name used_p)












{ df pr0, 
     pr1; 
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
    cf getpr0: get_properties_subdomain( nfs[0][i],nfs[1][k],nfs[2][l],nf0[0][i],nf0[1][k],nf0[2][l],h[0],h[1],h[2],cx[0],cx[1],cx[2],
                                            sm,fi[i][k][l],p[i][k][l],npfs[i][k][l],  pr0[i][k][l]) >> (used_fi[i][k][l],used_p[i][k][l]);
  cf getpr1: array3d_real1d_reduce_sum_real1d( nf,13,pr0,  pr1);
  cf getpr2: get_properties_finish( am,pm,pr1,  prop);
}





import c_print_x( int ,int ,int ,real ) as print_x;
import c_print_y( int ,int ,int ,real ) as print_y;
import c_print_z( int ,int ,int ,real ) as print_z;

import c_print_x_seq( int ,int ,int ,real ,value ,  name ) as print_x_seq;
import c_print_y_seq( int ,int ,int ,real ,value ,  name ) as print_y_seq;
import c_print_z_seq( int ,int ,int ,real ,value ,  name ) as print_z_seq;

sub free3d_if1( name nf,name a3d,name df_check)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf free: empty( df_check) --> (a3d[i][k][l]);
}

sub empty3d_0( name nf,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty0() >> (v[i][k][l]);
}

sub empty3d_1( name nf,name v1,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty1( v1[i][k][l]) >> (v[i][k][l]);
}

sub empty3d_2( name nf,name v1,name v2,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty2( v1[i][k][l],v2[i][k][l]) >> (v[i][k][l]);
}

sub empty3d_3( name nf,name v1,name v2,name v3,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty3( v1[i][k][l],v2[i][k][l],v3[i][k][l]) >> (v[i][k][l]);
}
sub empty3d_4( name nf,name v1,name v2,name v3,name v4,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty4( v1[i][k][l],v2[i][k][l],v3[i][k][l],v4[i][k][l]) >> (v[i][k][l]);
}
sub empty3d_5( name nf,name v1,name v2,name v3,name v4,name v5,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty5( v1[i][k][l],v2[i][k][l],v3[i][k][l],v4[i][k][l],v5[i][k][l]) >> (v[i][k][l]);
}
sub empty3d_6( name nf,name v1,name v2,name v3,name v4,name v5,name v6,  name v)
{
  for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1 cf emp: empty6( v1[i][k][l],v2[i][k][l],v3[i][k][l],v4[i][k][l],v5[i][k][l],v6[i][k][l]) >> (v[i][k][l]);
}



sub main(string args)
{
  df nt,          
     nts0,nts,    
     n,           
     nf,          
     nfs,         
     nf0,         
     np0,         
     np,          
     npfs,        
     p,pt,px,     
     ro,          
     fi0,         
     fp,fi,       
     fx,fy,fz,    
     xn,          
     cx,          
     xf1,         
     xf2,         
     pm,          
     am,          
     sm,          
     r0,          
     dv,          
     eps,         
     wp,          
     h,           
     tau,         
     count,       
     prop,        
     seq,seqlog,seqplt,
     used_px_density,used_fi0_poisson,used_px_velocity,used_fi_velocity,used_fxyz_velocity,
     used_p_density,used_p_move,used_fxyz_move,
     used_fp_poisson,used_fp_dobavka,used_fi_force,
     used_fi_prop,used_p_prop,
     used_ro_log,
     ready_it,
     used_fi_log,used_fp_log,used_fx_log,used_fy_log,used_fz_log,used_p_log;

  
  cf initpar: init_parameters( args,  nt,nts0,np0, n, nf, xn, tau,pm,sm,r0, dv, eps,wp);
  cf printpar: print_parameters( nt,nts0,np0, n[0],n[1],n[2], nf[0],nf[1],nf[2], xn[0],xn[1],xn[2], tau,pm,sm,r0, dv[0],dv[1],dv[2], eps,wp);

  if (nts0 != 0) assign_int( nts0,  nts);
  if (nts0 == 0) assign_int( nt+1,  nts);

  cf init_h0: assign_real( xn[0]/n[0],  h[0]);
  cf init_h1: assign_real( xn[1]/n[1],  h[1]);
  cf init_h2: assign_real( xn[2]/n[2],  h[2]);
  cf init_cx0: assign_real( xn[0]/2.0,  cx[0]);
  cf init_cx1: assign_real( xn[1]/2.0,  cx[1]);
  cf init_cx2: assign_real( xn[2]/2.0,  cx[2]);
  cf init_am: assign_real( pm/np,  am);

  
  cf frag_mesh: make_mesh3d_fragmentation( n,nf,1,  nfs,nf0);

  assign_int( 1,  seq[0]);
  assign_int( 1,  ready_it[0-1]);

  

  cf frag_sub0: init_subdomains_parameters( nf[0],nfs[0],nf0[0],h[0],  xf1[0],xf2[0]);
  cf frag_sub1: init_subdomains_parameters( nf[1],nfs[1],nf0[1],h[1],  xf1[1],xf2[1]);
  cf frag_sub2: init_subdomains_parameters( nf[2],nfs[2],nf0[2],h[2],  xf1[2],xf2[2]);




  

  gnuplot_script_init("dopng.plt",seqplt[0]);

  
  
  cf initp: init_particles_circle_yz( np0,4,nf,xf1,xf2,cx,r0,  px,npfs[0],np);
  
  

  if (np0 != np) puts("Actual number of particles: "+np);

  cf dens0: density( nf,nfs,nf0,h,am,px,npfs[0],  ro[0],  used_px_density);
  cf ipoi: init_poisson( nf,nfs,nf0,h,cx,pm,  fi0);
  cf poi0: poisson3d_solve_explicit( nf,nfs,h,wp,eps,4*3.1415926535897932384626433832795,1,ro[0],fi0,  fp[0],count[0],  used_fi0_poisson);
  cf pad0: fi_dobavka( nf,nfs,nf0,h,cx,sm,fp[0],  fi[0],  used_fp_dobavka[0]);

  puts("Poisson ["+0+"] : "+count[0]);
  cf frc0: force( nf,nfs,h,fi[0],  fx[0],fy[0],fz[0],  used_fi_force[0]);
  cf initv: init_particles_velocity_x( nf,nfs,nf0,h,cx,dv,0,tau,fi[0],fx[0],fy[0],fz[0],px,npfs[0],  p[0],  used_fi_velocity,used_fxyz_velocity,used_px_velocity) >> (ready_it[0]);
  

  let it = 0
  {
    cf prop0: get_properties( nf,nfs,nf0,h,cx,am,pm,sm,fi[it],p[it],npfs[it],  prop[it],  used_fi_prop[0],used_p_prop[0]);
    cf pprn0: print_properties_seq( "log.txt",prop[it],it,cx[0],cx[1],cx[2],seq[0],  seqlog[0]) --> (prop[it]);

    if (nts0!=0)
    { df used_ro, seqplt0;
      cf cp1: copy( seqplt[0],seqplt0[0]) --> (seqplt[0]);

      log_xy_plt_used( "ro_xy",it,n,nf,nfs,nf0,1,ro[it],n[2]/2,"dopng.plt",seqplt0[ 0],  seqplt0[ 1],  used_ro[0]);
      log_xz_plt_used( "ro_xz",it,n,nf,nfs,nf0,1,ro[it],n[1]/2,"dopng.plt",seqplt0[ 1],  seqplt0[ 2],  used_ro[1]);
      log_yz_plt_used( "ro_yz",it,n,nf,nfs,nf0,1,ro[it],n[0]/2,"dopng.plt",seqplt0[ 2],  seqplt0[ 3],  used_ro[2]);
      cf use: empty3d_3( nf,used_ro[0],used_ro[1],used_ro[2],  used_ro_log[0]);
      

      
      
      cf no_use_fp: empty3d_0( nf,  used_fp_log[0]);

      
      
      cf no_use_fi: empty3d_0( nf,  used_fi_log[0]);

      
      
      cf no_use_fx: empty3d_0( nf,  used_fx_log[0]);

      
      
      cf no_use_fy: empty3d_0( nf,  used_fy_log[0]);

      
      
      cf no_use_fz: empty3d_0( nf,  used_fz_log[0]);

      
      cf no_use_p: empty3d_0( nf,  used_p_log[0]);

      
      cf cp2: copy( seqplt0[3],  seqplt[3]);
      
    }
    if (nts0==0)
    { cf no_cpy: copy( seqplt[0],  seqplt[3]) --> (seqplt[0]);
      cf no_use_ro: empty3d_0( nf,  used_ro_log[0]);
      cf no_use_fp: empty3d_0( nf,  used_fp_log[0]);
      cf no_use_fi: empty3d_0( nf,  used_fi_log[0]);
      cf no_use_fx: empty3d_0( nf,  used_fx_log[0]);
      cf no_use_fy: empty3d_0( nf,  used_fy_log[0]);
      cf no_use_fz: empty3d_0( nf,  used_fz_log[0]);
      cf no_use_p: empty3d_0( nf,  used_p_log[0]);
    }
  }

  
  if (nt!=0) for i=0..nf[0]-1 for k=0..nf[1]-1 for l=0..nf[2]-1
  {
    cf free_px: empty2( used_px_density[i][k][l],used_px_velocity[i][k][l]) --> (px[i][k][l], used_px_density[i][k][l],used_px_velocity[i][k][l]);
    cf free_fi0: empty1( used_fi0_poisson[i][k][l]) --> (fi0[i][k][l], used_fi0_poisson[i][k][l]);
    cf free_fi_0: empty4( used_fi_force[0][i][k][l],used_fi_velocity[i][k][l],used_fi_prop[0][i][k][l],used_fi_log[0][i][k][l]) --> (fi[0][i][k][l], used_fi_force[0][i][k][l],used_fi_velocity[i][k][l],used_fi_prop[0][i][k][l],used_fi_log[0][i][k][l]);

	cf free_fxyz_0: empty5(
		 used_fxyz_velocity[i][k][l],
		used_fxyz_move[0][i][k][l],
		used_fx_log[0][i][k][l],
		used_fy_log[0][i][k][l],
		used_fz_log[0][i][k][l]
	) --> (
		fx[0][i][k][l],
		fy[0][i][k][l],fz[0][i][k][l],
		used_fxyz_velocity[i][k][l],
		used_fxyz_move[0][i][k][l],
		used_fx_log[0][i][k][l],
		used_fy_log[0][i][k][l],
		used_fz_log[0][i][k][l]
	);



  }

}
